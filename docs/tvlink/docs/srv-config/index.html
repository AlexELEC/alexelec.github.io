<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Налаштування сервера.
  #


Дана інформація стосується налаштувань на сторінці «Settings».

img
«Server port» – задає порт на якому «TVLINK» приймає запити. Порт у потоків буде більший на одиницю: “Server port &#43; 1”.
«Playlist IP» – це адреса, яку «TVLINK» буде використовувати для плейлистів (коли «Auto playlist IP» вимкнено). Вибирається із списку.
«Auto playlist IP» – якщо ввімкнуто, «TVLINK» буде використовувати ту IP-адресу в плейлисті, на яку робить запит клієнт.
«Check internet IP» – IP-адреса за якою «TVLINK» перевіряє роботу інтернет. За замовчуванням використовуються адреса «8.8.8.8». Якщо вам потрібно змінити цю адресу перед запуском програми, створіть файл «check-internet.ip» в каталозі «tvlink» и впишіть туди потрібну адресу.
«Check internet max time» – максимальний час, протягом якого «TVLINK» перевіряє роботу інтернет. Програма не запуститься поки у неї не буде доступу до інтернет.
«Refresh sources at startup» – оновлювати джерела при старті програми.
«Refresh sources at playlist» – оновлювати джерела при запиті плейлиста.
«Create static playlist» – створює статичні файли плейлистів (основний і для профілів) в каталозі «tvlink/playlist» і видає його при запиті клієнтів. Це набагато пришвидшує роботу, коли ви маєте велику кількість каналів (100 і більше). Статичний плейлист створюється (оновлюється) кожного разу коли автоматично оновлюються джерела каналів, або ви натискаєте на «Update all sources» на сторінці «Sources». Для токенів (Authentication Token) статичні плейлисти не створюється.
«Remove broken channels» – «TVLINK» автоматично буде видаляти усі канали, які виявилися непрацездатними. Будьте обережні з цією опцією, якщо зникне підключення до Інтернет, «TVLINK» почне видаляти кожен канал, який Ви будете вмикати.
«Authentication webUI» – проста автентифікація (логін/пароль) для веб-інтерфейсу. Після активації ви відразу побачите вікно для введення даних. Вам потрібно ввести – “admin/admin”. Після цього ви можете вказати свої логін/пароль у полях «Login (webUI)» та «Password (webUI)» відповідно. Якщо в полі «Login (webUI)» ввести порожній рядок або менше трьох символів, логін буде скинутий на значення за замовчуванням (admin). Це стосується і поля «Password (webUI)»: порожній рядок або менше трьох символів скинуть пароль на “admin”.
IP-адреси для списку «Playlist IP» беруться із системи. Якщо вам потрібно додати IP-адресу (або доменне ім’я) якої немає в системі (наприклад, якщо «TVLINK» працює за NAT), створіть файл «ip-address.ext» в каталозі «tvlink/data». Кожний рядок файлу повинен містити одну IP-адресу або доменне ім’я. Наприклад:">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://alexelec.github.io/docs/tvlink/docs/srv-config/">
  <meta property="og:site_name" content="AlexELEC">
  <meta property="og:title" content="Налаштування сервера та потоків">
  <meta property="og:description" content="Налаштування сервера. # Дана інформація стосується налаштувань на сторінці «Settings».
img
«Server port» – задає порт на якому «TVLINK» приймає запити. Порт у потоків буде більший на одиницю: “Server port &#43; 1”. «Playlist IP» – це адреса, яку «TVLINK» буде використовувати для плейлистів (коли «Auto playlist IP» вимкнено). Вибирається із списку. «Auto playlist IP» – якщо ввімкнуто, «TVLINK» буде використовувати ту IP-адресу в плейлисті, на яку робить запит клієнт. «Check internet IP» – IP-адреса за якою «TVLINK» перевіряє роботу інтернет. За замовчуванням використовуються адреса «8.8.8.8». Якщо вам потрібно змінити цю адресу перед запуском програми, створіть файл «check-internet.ip» в каталозі «tvlink» и впишіть туди потрібну адресу. «Check internet max time» – максимальний час, протягом якого «TVLINK» перевіряє роботу інтернет. Програма не запуститься поки у неї не буде доступу до інтернет. «Refresh sources at startup» – оновлювати джерела при старті програми. «Refresh sources at playlist» – оновлювати джерела при запиті плейлиста. «Create static playlist» – створює статичні файли плейлистів (основний і для профілів) в каталозі «tvlink/playlist» і видає його при запиті клієнтів. Це набагато пришвидшує роботу, коли ви маєте велику кількість каналів (100 і більше). Статичний плейлист створюється (оновлюється) кожного разу коли автоматично оновлюються джерела каналів, або ви натискаєте на «Update all sources» на сторінці «Sources». Для токенів (Authentication Token) статичні плейлисти не створюється. «Remove broken channels» – «TVLINK» автоматично буде видаляти усі канали, які виявилися непрацездатними. Будьте обережні з цією опцією, якщо зникне підключення до Інтернет, «TVLINK» почне видаляти кожен канал, який Ви будете вмикати. «Authentication webUI» – проста автентифікація (логін/пароль) для веб-інтерфейсу. Після активації ви відразу побачите вікно для введення даних. Вам потрібно ввести – “admin/admin”. Після цього ви можете вказати свої логін/пароль у полях «Login (webUI)» та «Password (webUI)» відповідно. Якщо в полі «Login (webUI)» ввести порожній рядок або менше трьох символів, логін буде скинутий на значення за замовчуванням (admin). Це стосується і поля «Password (webUI)»: порожній рядок або менше трьох символів скинуть пароль на “admin”. IP-адреси для списку «Playlist IP» беруться із системи. Якщо вам потрібно додати IP-адресу (або доменне ім’я) якої немає в системі (наприклад, якщо «TVLINK» працює за NAT), створіть файл «ip-address.ext» в каталозі «tvlink/data». Кожний рядок файлу повинен містити одну IP-адресу або доменне ім’я. Наприклад:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>Налаштування сервера та потоків | AlexELEC</title>
<link rel="icon" href="/icon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://alexelec.github.io/docs/tvlink/docs/srv-config/">
  <link rel="alternate" hreflang="uk" href="https://alexelec.github.io/uk/docs/tvlink/docs/srv-config/" title="Налаштування сервера та потоків">
<link rel="stylesheet" href="/book.min.e9f68c3fff3d8236a489d16a9caf6de5e4d1a29c20eb4b5524e42cd30be4d319.css" integrity="sha256-6faMP/89gjakidFqnK9t5eTRopwg60tVJOQs0wvk0xk=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.aa61e281c9638b61f2057a70b8eb1f2d87a396f308eb33e984576dee16dbf8a0.js" integrity="sha256-qmHigclji2HyBXpwuOsfLYejlvMI6zPphFdt7hbb&#43;KA=" crossorigin="anonymous"></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><img src="/icon.png" alt="Logo" class="book-icon" /><span>AlexELEC</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>



  




  


<ul class="book-languages">
  <li>
    <input type="checkbox" id="languages" class="toggle" />
    <label for="languages" class="flex justify-between">
      <a role="button" class="flex align-center">
        <img src="/svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </label>

    <ul>
      
      <li>
        <a href="/uk/docs/tvlink/docs/srv-config/">
          Українська
        </a>
      </li>
      
    </ul>
  </li>
</ul>














  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-756553081c1b2cc791b9c27edc4450dc" class="toggle" checked />
    <label for="section-756553081c1b2cc791b9c27edc4450dc" class="flex justify-between">
      <a role="button" class="">TVLINK</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/overview/" class="">Overview</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/install/" class="">Installation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/quick-start/" class="">Швидкий старт</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/srv-config/" class="active">Налаштування сервера та потоків</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/source/" class="">Налаштування джерел каналів</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/epg/" class="">Розклад передач (EPG)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/profiles/" class="">Профілі користувачів</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/channels/" class="">Канали</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/gpoups/" class="">Групи каналів</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/status/" class="">Статус роботи та оновлення програми</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/pvr-tvlink-client/" class="">PVR TVLINK Client</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tvlink/docs/tvlink-simple-conrol/" class="">TVLINK Simple Control</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Налаштування сервера та потоків</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#налаштування-сервера">Налаштування сервера.</a></li>
        <li><a href="#маркер-автентифікації-для-потоків-та-плейлистів">Маркер автентифікації для потоків та плейлистів.</a></li>
        <li><a href="#періодичне-перезавантаження-налаштувань">Періодичне перезавантаження налаштувань.</a></li>
        <li><a href="#налаштування-потоків">Налаштування потоків.</a></li>
        <li><a href="#опис-деяких-не-дуже-зрозумілих-параметрів-tvlink">Опис деяких, не дуже зрозумілих, параметрів «TVLINK».</a></li>
        <li><a href="#ffmpeg-transcode-stream">FFmpeg transcode stream.</a></li>
        <li><a href="#оновлення-epg">Оновлення EPG.</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h2 id="налаштування-сервера">
  Налаштування сервера.
  <a class="anchor" href="#%d0%bd%d0%b0%d0%bb%d0%b0%d1%88%d1%82%d1%83%d0%b2%d0%b0%d0%bd%d0%bd%d1%8f-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0">#</a>
</h2>
<blockquote class="book-hint info">
<p>Дана інформація стосується налаштувань на сторінці «Settings».</p>
</blockquote>
<p>img</p>
<p>«Server port» – задає порт на якому «TVLINK» приймає запити. Порт у потоків буде більший на одиницю: “Server port + 1”.
«Playlist IP» – це адреса, яку «TVLINK» буде використовувати для плейлистів (коли «Auto playlist IP» вимкнено). Вибирається із списку.
«Auto playlist IP» – якщо ввімкнуто, «TVLINK» буде використовувати ту IP-адресу в плейлисті, на яку робить запит клієнт.
«Check internet IP» – IP-адреса за якою «TVLINK» перевіряє роботу інтернет. За замовчуванням використовуються адреса «8.8.8.8». Якщо вам потрібно змінити цю адресу перед запуском програми, створіть файл «check-internet.ip» в каталозі «tvlink» и впишіть туди потрібну адресу.
«Check internet max time» – максимальний час, протягом якого «TVLINK» перевіряє роботу інтернет. Програма не запуститься поки у неї не буде доступу до інтернет.
«Refresh sources at startup» – оновлювати джерела при старті програми.
«Refresh sources at playlist» – оновлювати джерела при запиті плейлиста.
«Create static playlist» – створює статичні файли плейлистів (основний і для профілів) в каталозі «tvlink/playlist» і видає його при запиті клієнтів. Це набагато пришвидшує роботу, коли ви маєте велику кількість каналів (100 і більше). Статичний плейлист створюється (оновлюється) кожного разу коли автоматично оновлюються джерела каналів, або ви натискаєте на «Update all sources» на сторінці «Sources». Для токенів (Authentication Token) статичні плейлисти не створюється.
«Remove broken channels» – «TVLINK» автоматично буде видаляти усі канали, які виявилися непрацездатними. Будьте обережні з цією опцією, якщо зникне підключення до Інтернет, «TVLINK» почне видаляти кожен канал, який Ви будете вмикати.
«Authentication webUI» – проста автентифікація (логін/пароль) для веб-інтерфейсу. Після активації ви відразу побачите вікно для введення даних. Вам потрібно ввести – “admin/admin”. Після цього ви можете вказати свої логін/пароль у полях «Login (webUI)» та «Password (webUI)» відповідно. Якщо в полі «Login (webUI)» ввести порожній рядок або менше трьох символів, логін буде скинутий на значення за замовчуванням (admin). Це стосується і поля «Password (webUI)»: порожній рядок або менше трьох символів скинуть пароль на “admin”.
IP-адреси для списку «Playlist IP» беруться із системи. Якщо вам потрібно додати IP-адресу (або доменне ім’я) якої немає в системі (наприклад, якщо «TVLINK» працює за NAT), створіть файл «ip-address.ext» в каталозі «tvlink/data». Кожний рядок файлу повинен містити одну IP-адресу або доменне ім’я. Наприклад:</p>
<p>100.100.100.100
200.200.200.200
my.own.server.com</p>
<h2 id="маркер-автентифікації-для-потоків-та-плейлистів">
  Маркер автентифікації для потоків та плейлистів.
  <a class="anchor" href="#%d0%bc%d0%b0%d1%80%d0%ba%d0%b5%d1%80-%d0%b0%d0%b2%d1%82%d0%b5%d0%bd%d1%82%d0%b8%d1%84%d1%96%d0%ba%d0%b0%d1%86%d1%96%d1%97-%d0%b4%d0%bb%d1%8f-%d0%bf%d0%be%d1%82%d0%be%d0%ba%d1%96%d0%b2-%d1%82%d0%b0-%d0%bf%d0%bb%d0%b5%d0%b9%d0%bb%d0%b8%d1%81%d1%82%d1%96%d0%b2">#</a>
</h2>
<p>img</p>
<p>Захист від несанкціонованого доступу до потоків та плейлистів.</p>
<p>«Authentication Token» – вмикає підтримку маркерів автентифікації.
«Main Token for playlist/streams» – будь-яка послідовність латинських літер та/або цифр, чутлива до регістру.
Після будь-яких змін в налаштуваннях «Токенів» потрібно застосувати налаштування («Apply Settings» внизу сторінки) або перезавантажити програму.</p>
<p>Якщо у Вас ввімкнена опція «Create static playlist» то при будь-яких змінах в налаштуваннях «Токенів», не забувайте оновити статичні плейлисти (натисніть «Update all sources» на сторінці «Sources»).</p>
<p>Якщо опцію «Authentication Token» активовано, після застосування налаштувань , доступ до потоків та плейлистів здійснюється лише через токен. На сторінці «Settings» задається токен для основного плейлиста.</p>
<p>img</p>
<p>Інші токени задаються в «Профілях користувачів».</p>
<h2 id="періодичне-перезавантаження-налаштувань">
  Періодичне перезавантаження налаштувань.
  <a class="anchor" href="#%d0%bf%d0%b5%d1%80%d1%96%d0%be%d0%b4%d0%b8%d1%87%d0%bd%d0%b5-%d0%bf%d0%b5%d1%80%d0%b5%d0%b7%d0%b0%d0%b2%d0%b0%d0%bd%d1%82%d0%b0%d0%b6%d0%b5%d0%bd%d0%bd%d1%8f-%d0%bd%d0%b0%d0%bb%d0%b0%d1%88%d1%82%d1%83%d0%b2%d0%b0%d0%bd%d1%8c">#</a>
</h2>
<p>img</p>
<p>Ця функція перезавантажує налаштування «TVLINK» через вказані проміжки часу. Ця дія аналогічна «Apply Settings» внизу сторінки. Вона не перезавантажує саму програму, а тільки заново ініціює всі налаштування. Але, це сприяє очищенню оперативної пам’яті та закриттю всіх сокетів. Тому може бути корисна, коли сервер працює 24/7.</p>
<p>«Reload by interval» – перезавантажувати модулі «TVLINK» через проміжок часу (у годиннику) вказаний у «Reload every hours».
«Reload once a day» – перезавантажувати один раз на добу, у визначений параметром «Reload at o’clock» час.
Час вказаний в цих опціях не точний. Наприклад, якщо вказано «Reload once a day» / «Reload at o’clock» – в 4 години, перезавантаження станеться між четвертою та п’ятою годинами.</p>
<p>«Reload once a day» має вищий пріоритет. Якщо Ви увімкнете обидва параметри, перезавантаження модулів працюватиме один раз на добу.</p>
<p>Перезавантаження відбуваються тільки якщо:</p>
<p>кількість відкритих сокетів (з’єднань) перевищує 10
програма використовує більше ніж 60 Мб оперативної пам’яті для систем де RAM менше за 1.5 Гб та більше 120 Мб для систем де RAM перевищує 1.5 Гб.
Щоб уникнути проблем із трансляцією потоків, функції спрацюють, якщо в цей момент «TVLINK» не веде мовлення (немає підключених клієнтів). Як тільки вимкнеться останній клієнт відбудеться перезавантаження модулів.</p>
<p>Якщо ввімкнена опція «Ignore connected clients on Reload», модулі «TVLINK» буде перезавантажено не зважаючи на те що є підключені кліенти.</p>
<hr>
<p>«Empty channel link» – дозволяє вписати своє посилання на потік, який буде відтворюватися якщо жодне з посилань на канал не працює.</p>
<p>img</p>
<p>«Exclude these lines from channel names when mapping» – виключення слів з назв каналів. Ви можете виключити будь-які рядки з назви каналу для автоматичного зв’язування. Сама назва каналу при цьому залишається незмінною, проте «TVLINK» при автоматичному зв’язуванні відкидає вказану вами частину з назви. Розділювачем слів, які потрібно виключити з назви, є кома (без пробілів). Наприклад, при таких налаштуваннях</p>
<p>всі канали з такими іменами будуть вважатися одним і тим же каналом – «Discovery Science HD» .</p>
<p>«Discovery Science HD»
«Discovery Science HD orig»
«Discovery Science HD PREMIUM+»
Для інформації. Якщо в одному джерелі є канали, як показано вище, то найвищий пріоритет буде у потоку (посилання на потік) назва якого найдовша, тобто спочатку «Discovery Science HD PREMIUM+», потім «Discovery Science HD orig» і останній «Discovery Science HD».</p>
<p>«M3U playlist settings» – дозволяє додати потрібні вам елементи після тегів «EXTM3U» та «EXTINF» в плейлист «TVLINK». Наприклад, це може бути інформація для періодичного оновлення списку каналів: «refresh=”3600″». Якщо ваш IPTV програвач підтримує це.</p>
<hr>
<h2 id="налаштування-потоків">
  Налаштування потоків.
  <a class="anchor" href="#%d0%bd%d0%b0%d0%bb%d0%b0%d1%88%d1%82%d1%83%d0%b2%d0%b0%d0%bd%d0%bd%d1%8f-%d0%bf%d0%be%d1%82%d0%be%d0%ba%d1%96%d0%b2">#</a>
</h2>
<p>img</p>
<p>«Main User-Agent» – задає User-Agent за умовчанням. У деяких IPTV-провайдерів може стояти блокування по «user-agent». Вони віддають потік, тільки якщо запит іде від визначеної програми.  Ви можете вказати «TVLINK», щоб він видавав себе за іншу програму.</p>
<p>Наступні налаштування здебільшого відносяться до модуля «Streamlink» і відповідають за роботу з потоками.</p>
<p>«Stream Ring buffer» – задає розмір буфера для потоків (в мегабайтах). Відповідає параметру «ringbuffer-size» в «Streamlink».
«Chunk size» – задає розмір фрагмента під час читання потоку (в байтах). Чим більший розмір фрагмента, то менше навантаження на процесор. Чим менший розмір фрагмента, тим швидше відкривається потік.
«Threads job timeout» – час (в секундах) через який буде припинено роботу ланцюжка по читанню/запису фрагментів потоку. Коли це спрацьовує «Streamlink» перестане транслювати потік, але може не закрити з’єднання. Тому рекомендується вибирати значення для цього параметра біле ніж максимальне значення в опціях «General HTTP timeout» та «HLS segment timeout», про які йдеться нижче. Частково відповідає параметру «stream-timeout» в «Streamlink».
«General HTTP timeout Connect/Data» – загальний тайм-аут (в секундах) , який використовується для всіх HTTP-запитів, крім тих, які охоплюються іншими параметрами. Для розуміння: в HLS-потоках це буде таймаут для отримання списку сигментів. Окремо встановлюється час (таймаут) для підключення та час на отримання даних, відповідно. Відповідає параметру «http-timeout» в «Streamlink», окрім того, що дає змогу встановити різні значення для з’єднання та читання даних.
«HLS segment timeout Connect/Data» – тайм-аут (в секундах) , який використовується для HLS-сегментів (а також DASH и тому подібне). Окремо встановлюється час (таймаут) для підключення та час на отримання даних, відповідно. Відповідає параметру «stream-segment-timeout» в «Streamlink», окрім того, що дає змогу встановити різні значення для з’єднання та читання даних.
«HLS segment queue threshold» – Коефіцієнт множення цільової тривалості списку відтворення HLS, після якого потік буде зупинено достроково, якщо після оновлення списку відтворення у чергу не буде поставлено нових сегментів. Відповідає параметру «hls-segment-queue-threshold» в «Streamlink».
«Stream retry count» – ця опція встановлює переметри «stream-segment-attempts» та «hls-playlist-reload-attempts» для «Streamlink». Тобто кількість спроб завантаження для сигментів та списку сигментів.
«Segment threads» – кількість паралельних завантажень сегментів. Це розмір пулу потоків, який використовується для завантаження сегментів. Відповідає параметру «stream-segment-threads» в «Streamlink».
«Segments Queue» – розмір черги сегментів. В «Streamlink» вона є сталою, 20 сегментів. Але це забагато для Live-потоків. Чим меньша чегра тим скоріш будуть закриватися потоки, а також буде меньше споживання оперативної пам’яті та кількості відкритих сокетів. Краще встановити «as threads», тобто відповідає кількості «Segment threads» але не меньше чим 6 сегментів.
«HLS live edge» – задає скільки HLS-сегментів потрібно завантажити при старті потоку. Відповідає параметру «hls-live-edge» в «Streamlink».
«HLS playlist reload time» – контролює час через який виконується запит для оновлення списку сегментів. Частково відповідає параметру «hls-playlist-reload-time» в «Streamlink». Параметр «segment» має таке ж значення як і в «Streamlink». Значення «duration» відповідає «default» в «Streamlink». Значення «average» це середній час двох сегментів. Значення «default» це або одне зі значень яким відповідають «duration» / «segment», або якщо їх не має встановлено час – 6 секунд.
«HLS Stream Data» – якщо активовано, негайно передає дані з сегмента в вихідний буфер під час завантаження. Канали відкриваються швидко, без попередньої буферизації перед стартом. Якщо вимкнено, дані передаються тільки після завантаження першого сигмента. Відповідає параметру «hls-segment-stream-data» в «Streamlink».
«HLS Live Restart» – якщо активно, перейти до початку прямої трансляції або якнайдалі назад. Відповідає параметру «hls-live-restart» в «Streamlink».
«Debug Streams» – додає журнал роботи модуля «Streamlink» в журнал роботи «TVLINK». Файл журналу роботи знаходиться в каталозі «tvlink/log».
«Sources Proxy» та «Streams Proxy» – дозволяють встановити проксі для джерел та потоків. Формат: «http://login:password@your.proxy:port». Значення «login/password» не обов’язкові. Підтримуються протоколи: http, https, socks5.</p>
<p>Для більшості налаштувань на цій сторінці, щоб зміни набули чинності, потрібно перечитати конфігурацію «TVLINK». Для цього є опція «Apply Settings» внизу сторінки. Опції «Refresh sources at playlist» та «Remove broken channels» цього не потребують.</p>
<hr>
<p>img</p>
<p>Такі налаштування потоків як:</p>
<p>Threads job timeout
General HTTP timeout
HLS segment timeout
HLS segment queue threshold
Stream retry count
HLS live edge
HLS Stream Data
HLS Live Restart
Ви можете встановити окремо для кожного джерела на сторінці «Sources» (іконка біля назви джерела). При цьому не потрібно тиснути на «Apply Settings», зміни набувають чинності одразу.</p>
<p>Ці самі параметри не потребують перезавантаження і на сторінці «Settings».</p>
<p>Кнопка «Default» в формі «Streamer settings» повертає всі окремі налаштування потоків для джерела до основних налаштувань на сторінці «Settings».</p>
<p>Поля:</p>
<p>Playlist URL – дає можливість змінити URL-адресу джерела
User-Agent – дає можливість встановити опцію “User-Agent” для кожного джерела (потоків в цьому джерелі) окремо. Підміняє собою опцію «Main User-Agent»
Зміни в налаштуваннях цих полів відбуваються одразу як поле втрачає фокус.</p>
<hr>
<h2 id="опис-деяких-не-дуже-зрозумілих-параметрів-tvlink">
  Опис деяких, не дуже зрозумілих, параметрів «TVLINK».
  <a class="anchor" href="#%d0%be%d0%bf%d0%b8%d1%81-%d0%b4%d0%b5%d1%8f%d0%ba%d0%b8%d1%85-%d0%bd%d0%b5-%d0%b4%d1%83%d0%b6%d0%b5-%d0%b7%d1%80%d0%be%d0%b7%d1%83%d0%bc%d1%96%d0%bb%d0%b8%d1%85-%d0%bf%d0%b0%d1%80%d0%b0%d0%bc%d0%b5%d1%82%d1%80%d1%96%d0%b2-tvlink">#</a>
</h2>
<p>Спочатку визначимо, чим відрізняються тайм-аути з’єднань і читання даних (Connect timeout та Read Data timeout).</p>
<p>«Connect timeout»
Коли клієнт (у цьому випадку TVLINK буде клієнтом по відношенню до серверу звідки він запитує потоки) ініціалізує з’єднання, він повинен отримати відповідь від сервера (спеціальний код відповіді). Не важливо, яка саме відповідь прийде від сервера. Це може бути відповідь 200 (підключення встановлено) або 302 (переадресація) або будь-яка інша, головне, щоб сервер відповів. Якщо в проміжок часу зазначеного в тайм-аут з’єднання (час очікування підключення) відповідь від сервера не надійшла, клієнт скидає з’єднання.</p>
<p>«Read Data timeout»
Коли клієнт отримує відповідь 200 (підключення встановлено) від сервера, він починає завантажувати (читати) дані, які віддає сервер. Якщо за проміжок часу вказаного в тайм-аут читання даних (час очікування читання даних) сервер не передає інформацію, клієнт скидає з’єднання.</p>
<p>Тепер визначимся з форматами потоків.</p>
<p>Найбільше розповсюджені з них це: TS та HLS.</p>
<p>«TS» це по суті теж саме, якби ви завантажували якийсь файл у браузері. Клієнт робить запит і, якщо отримує відповідь 200, просто послідовно отримує дані. Дані передаються в один потік і, якщо з трафіком виникають проблеми, це викликає проблеми і з відео. Тобто для IPTV через інтернет не краще рішення. Більше підходить для локальної мережі.</p>
<p>«HLS» це той же самий «TS» (спрощено звичайно), але порізаний на куски (сегменти). За рахунок того, що ці сегменти, це вже записані файли (у відмінності від TS, які ідуть у реальному часі) та їх (цих файлів) кілька, клієнт має можливість одночасно завантажити кілька сегментів. Що в свою чергу допомагає боротися з проблемами трафіку, і відповідно більше підходить для IPTV через інтернет.</p>
<p>Тепер безпосередньо про параметри «TVLINK».</p>
<p>«General HTTP timeout Connect/Data»
Якщо у вас TS-потік, саме ці тайм-аути будуть працювати. «HLS segment» тайм-аути не будуть приймати участь для таких потоків.</p>
<p>Якщо у вас HLS-потік, «General HTTP» тайм-аути працюватимуть, коли ви отримуєте плейлисти зі списком сегментів або варіантів якості потоків (провайдер може надати кілька варіантів якості потоків для різних швидкостей з’єднання). Плейлистами ми називаємо текстові файли, які містять посилання на інші плейлисти (наприклад, якщо це список якості потоків) або посилання на відеосегменти.</p>
<p>«HLS segment timeout Connect/Data»
Ці таймаути працюють безпосередньо з сегментами (відеофайлами). Хоча в назві цього параметра стоїть «HLS», ​​ці таймаути працюють і з іншими форматами сегментованих потоків. Наприклад, «DASH».</p>
<p>У простому випадку (без списку якості потоків) для HLS-потоків це буде виглядати так:</p>
<p>отримання списку сегментів – «General HTTP timeout»
завантаження сегменту 1 – «HLS segment timeout»
завантаження сегменту 2 – «HLS segment timeout»
завантаження сегменту 3 – «HLS segment timeout»
отримання нового списку сегментів – «General HTTP timeout»
завантаження сегменту 4 – «HLS segment timeout»
завантаження сегменту 5 – «HLS segment timeout»
завантаження сегменту 6 – «HLS segment timeout»
отримання нового списку сегментів – «General HTTP timeout»
і так далі…</p>
<p>«HLS segment queue threshold»
Цей параметр (тайм-аут) теж відноситься до HLS-потоків. Список HLS-сегментів (плейлист) містить змінну, де вказана тривалість відео в сегменті. Ця змінна використовується «TVLINK» для того, щоб дізнатися через який час запросити новий файл сегментів. Сервер постійно оновлює цей список, як тільки закінчено запис нового сегмента.</p>
<p>«HLS segment queue threshold» це число на яке буде помножено змінна тривалості сегмента. І якщо протягом часу (який ми отримали при множенні) на сервері не оновився список сегментів, клієнт розірве з’єднання.</p>
<p>Наприклад, у списку зазначено, що тривалість сегмента 6 секунд. «HLS segment queue threshold» у нас дорівнює трьом. Через 18 секунд клієнт розірве з’єднання, якщо на сервері не з’явився новий сегмент.</p>
<p>«Threads job timeout»
Це тайм-аут внутрішнього циклу «Streamlink», який читає дані зі входу і записує у вихідний потік. Якщо протягом зазначеного часу через цикл не проходять дані, він припиняє роботу. Відповідно, будь-яке з’єднання закривається. Закривається, це в теорії. Але в силу того, що модулі «Streamlink» не ідеальні з’єднання можуть залишитися відкритими. Тому я рекомендую ставити тут значення більше, ніж таймаути в «General HTTP» та «HLS segment».</p>
<p>«Stream retry count»
Число повторних спроб з’єднання при спрацьовуванні «General HTTP» та «HLS segment» тайм-аутів.</p>
<hr>
<h2 id="ffmpeg-transcode-stream">
  FFmpeg transcode stream.
  <a class="anchor" href="#ffmpeg-transcode-stream">#</a>
</h2>
<p>Якщо у вашій системі встановлено «FFmpeg», ви маєте можливість увімкнути модуль «FFmpeg transcode stream».</p>
<p>img</p>
<p>Опції – це параметри командного рядка FFmpeg. Призначення полів:</p>
<p>«Before input» – для параметрів апаратного транскодінгу
«Video encoder» – параметри відео енкодера
«Audio encoder» – параметри аудіо енкодера
Щоб було зрозуміло, як будуть вставлені ці параметри в командний рядок «FFmpeg», ось приклад (спрощена схема):</p>
<p>/usr/bin/ffmpeg -err_detect ignore_err -stream_loop -1 [Before input] -i 
  <a href="http://channel.stream">http://channel.stream</a> -c:v [Video encoder] -c:a [Audio encoder] -ignore_unknown -map 0:v -map 0:a -f mpegts
За замовчуванням «Video/Audio encoder» містить параметр “copy”. Тобто якщо ці рядки порожні, буде встановлено значення “copy” (пропускати потік без перекодування).</p>
<p>Перед тим, як встановлювати значення, переконайтеся, що «FFmpeg» в системі підтримує ті чи інші параметри. Наприклад, дайте команду</p>
<p>ffmpeg -hide_banner -encoders
щоб подивитися доступні аудіо/відео енкодери.</p>
<p>Якщо процесор у вашій системі (наприклад, Intel Pentium N5000) підтримує апаратне кодування потоків, можна зробити, наприклад, такі налаштування.</p>
<p>Before input:
-hwaccel vaapi -hwaccel_output_format vaapi -hwaccel_device /dev/dri/renderD128
Video encoder:
h264_vaapi -r 50
Audio encoder:
aac -b:a 96k
Після застосування налаштувань (Apply Settings) на сторінці «About» з’явиться посилання на «M3U FFmpeg Playlist» (формат: http://ip-address:port/ffmpeglist).</p>
<p>Увімкнення «FFmpeg transcode stream» не впливає на основний модуль трансляції. Вони працюють паралельно. Ви можете одночасно підключити одних клієнтів до звичайного плейлиста (playlist), а інших до плейлиста «FFmpeg» (ffmpeglist).</p>
<p>За посиланням «http://ip-address:port/ffmpeglist» ви завжди можете отримати плейлист, навіть якщо «FFmpeg transcode stream» вимкнено і в системі немає «FFmpeg». Тому будьте уважні.</p>
<p>Якщо увімкнути «Debug Streams» та запустити «TVLINK» з командного рядка, при зупинці потоку буде виведено інформацію «FFmpeg» (кодування, помилки тощо).</p>
<h2 id="оновлення-epg">
  Оновлення EPG.
  <a class="anchor" href="#%d0%be%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%bd%d1%8f-epg">#</a>
</h2>
<p>img</p>
<p>Ці налаштування відповідають за періодичне оновлення «EPG».</p>
<p>«Auto update EPG» – увімкнути/вимкнути періодичне оновлення EPG.
«Update period EPG» – вибрати зі списку період оновлення в годинах, або один раз на добу (вночі).</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#налаштування-сервера">Налаштування сервера.</a></li>
        <li><a href="#маркер-автентифікації-для-потоків-та-плейлистів">Маркер автентифікації для потоків та плейлистів.</a></li>
        <li><a href="#періодичне-перезавантаження-налаштувань">Періодичне перезавантаження налаштувань.</a></li>
        <li><a href="#налаштування-потоків">Налаштування потоків.</a></li>
        <li><a href="#опис-деяких-не-дуже-зрозумілих-параметрів-tvlink">Опис деяких, не дуже зрозумілих, параметрів «TVLINK».</a></li>
        <li><a href="#ffmpeg-transcode-stream">FFmpeg transcode stream.</a></li>
        <li><a href="#оновлення-epg">Оновлення EPG.</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












