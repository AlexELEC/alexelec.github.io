<!DOCTYPE html>
<html lang="uk" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Налаштування сервера
  #


Ця інформація стосується налаштувань на сторінці «Settings».


  


Для більшості налаштувань на цій сторінці, щоб зміни набули чинності, потрібно перечитати конфігурацію «TVLINK». Для цього є опція «Apply Settings» унизу сторінки.
Опції «Refresh sources at playlist» та «Remove broken channels» цього не потребують.



«Server port» – задає порт, на якому «TVLINK» приймає запити. Порт для потоків буде більший на одиницю: «Server port &#43; 1».


«Playlist IP» – це адреса, яку «TVLINK» використовуватиме для плейлистів (коли опцію «Auto playlist IP» вимкнено). Адресу можна вибрати зі списку.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://alexelec.github.io/uk/docs/tvlink/docs/settings/">
  <meta property="og:site_name" content="AlexELEC">
  <meta property="og:title" content="Налаштування сервера та потоків">
  <meta property="og:description" content="Налаштування сервера # Ця інформація стосується налаштувань на сторінці «Settings».
Для більшості налаштувань на цій сторінці, щоб зміни набули чинності, потрібно перечитати конфігурацію «TVLINK». Для цього є опція «Apply Settings» унизу сторінки. Опції «Refresh sources at playlist» та «Remove broken channels» цього не потребують.
«Server port» – задає порт, на якому «TVLINK» приймає запити. Порт для потоків буде більший на одиницю: «Server port &#43; 1».
«Playlist IP» – це адреса, яку «TVLINK» використовуватиме для плейлистів (коли опцію «Auto playlist IP» вимкнено). Адресу можна вибрати зі списку.">
  <meta property="og:locale" content="uk">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>Налаштування сервера та потоків | AlexELEC</title>
<link rel="icon" href="/icon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://alexelec.github.io/uk/docs/tvlink/docs/settings/">
  <link rel="alternate" hreflang="en" href="https://alexelec.github.io/docs/tvlink/docs/settings/" title="Server and Stream Configuration">
<link rel="stylesheet" href="/book.min.e9f68c3fff3d8236a489d16a9caf6de5e4d1a29c20eb4b5524e42cd30be4d319.css" integrity="sha256-6faMP/89gjakidFqnK9t5eTRopwg60tVJOQs0wvk0xk=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/uk.search.min.163188f5d2e9c09b166d6563a2f587e5585fcdc7961710ab96a2608635ba3e71.js" integrity="sha256-FjGI9dLpwJsWbWVjovWH5VhfzceWFxCrlqJghjW6PnE=" crossorigin="anonymous"></script>

  <script defer src="/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js" integrity="sha256-b2&#43;Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC&#43;NdcPIvZhzk=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/uk/"><img src="/icon.png" alt="Logo" class="book-icon" /><span>AlexELEC</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Пошук" aria-label="Пошук" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>



  




  


<ul class="book-languages">
  <li>
    <input type="checkbox" id="languages" class="toggle" />
    <label for="languages" class="flex justify-between">
      <a role="button" class="flex align-center">
        <img src="/svg/translate.svg" class="book-icon" alt="Languages" />
        Українська
      </a>
    </label>

    <ul>
      
      <li>
        <a href="/docs/tvlink/docs/settings/">
          English
        </a>
      </li>
      
    </ul>
  </li>
</ul>














  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f1ab66c78da02bdc35305e50e3dd78a0" class="toggle" checked />
    <label for="section-f1ab66c78da02bdc35305e50e3dd78a0" class="flex justify-between">
      <a role="button" class="">TVLINK</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/uk/docs/tvlink/docs/overview/" class="">Огляд</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/uk/docs/tvlink/docs/install/" class="">Встановлення та оновлення</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/uk/docs/tvlink/docs/quick-start/" class="">Швидкий старт</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/uk/docs/tvlink/docs/sources/" class="">Налаштування джерел каналів</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/uk/docs/tvlink/docs/epg/" class="">Розклад телевізійних передач (EPG)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/uk/docs/tvlink/docs/profiles/" class="">Профілі користувачів</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/uk/docs/tvlink/docs/channels/" class="">Канали</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/uk/docs/tvlink/docs/gpoups/" class="">Групи каналів</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/uk/docs/tvlink/docs/settings/" class="active">Налаштування сервера та потоків</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Налаштування сервера та потоків</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#налаштування-сервера">Налаштування сервера</a></li>
        <li><a href="#маркер-автентифікації-для-потоків-та-плейлистів">Маркер автентифікації для потоків та плейлистів</a></li>
        <li><a href="#періодичне-перезавантаження-налаштувань">Періодичне перезавантаження налаштувань</a></li>
        <li><a href="#empty-channel-link">«Empty channel link»</a></li>
        <li><a href="#exclude-these-lines-from-channel-names-when-mapping">«Exclude these lines from channel names when mapping»</a></li>
        <li><a href="#m3u-playlist-settings">«M3U playlist settings»</a></li>
        <li><a href="#налаштування-потоків">Налаштування потоків</a></li>
        <li><a href="#налаштування-потоків-для-окремих-джерел">Налаштування потоків для окремих джерел</a></li>
        <li><a href="#пояснення-щодо-налаштування-роботи-потоків">Пояснення щодо налаштування роботи потоків</a></li>
        <li><a href="#ffmpeg-transcode-stream">FFmpeg transcode stream</a></li>
        <li><a href="#оновлення-epg">Оновлення EPG</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h2 id="налаштування-сервера">
  Налаштування сервера
  <a class="anchor" href="#%d0%bd%d0%b0%d0%bb%d0%b0%d1%88%d1%82%d1%83%d0%b2%d0%b0%d0%bd%d0%bd%d1%8f-%d1%81%d0%b5%d1%80%d0%b2%d0%b5%d1%80%d0%b0">#</a>
</h2>
<blockquote class="book-hint info">
<p>Ця інформація стосується налаштувань на сторінці «Settings».</p>
</blockquote>
<p align="center">
  <a href="/tvlink/settings/01.png"><img src="/tvlink/settings/01.png" width="480"/></a>
</p>
<blockquote class="book-hint info">
<p>Для більшості налаштувань на цій сторінці, щоб зміни набули чинності, потрібно перечитати конфігурацію «TVLINK». Для цього є опція «Apply Settings» унизу сторінки.
Опції «Refresh sources at playlist» та «Remove broken channels» цього не потребують.</p>
</blockquote>
<ul>
<li>
<p>«Server port» – задає порт, на якому «TVLINK» приймає запити. Порт для потоків буде більший на одиницю: «Server port + 1».</p>
</li>
<li>
<p>«Playlist IP» – це адреса, яку «TVLINK» використовуватиме для плейлистів (коли опцію «Auto playlist IP» вимкнено). Адресу можна вибрати зі списку.</p>
</li>
<li>
<p>«Auto playlist IP» – якщо цю опцію ввімкнено, «TVLINK» використовуватиме ту IP-адресу в плейлисті, з якої надходить запит від клієнта.</p>
</li>
<li>
<p>«Check internet IP» – IP-адреса, за якою «TVLINK» перевіряє підключення до інтернету. За замовчуванням використовується адреса «8.8.8.8».
Якщо вам потрібно змінити цю адресу перед запуском програми, створіть файл «check-internet.ip» у каталозі tvlink і впишіть туди потрібну адресу.</p>
</li>
<li>
<p>«Check internet max time» – максимальний час, протягом якого «TVLINK» перевіряє підключення до інтернету. Програма не запуститься, доки не матиме доступу до інтернету.</p>
</li>
<li>
<p>«Refresh sources at startup» – оновлювати джерела під час запуску програми.</p>
</li>
<li>
<p>«Refresh sources at playlist» – оновлювати джерела під час запиту плейлиста.</p>
</li>
<li>
<p>«Create static playlist» – створює статичні файли плейлистів (основний та для профілів) у каталозі «tvlink/playlist» і видає їх на запит клієнтів.
Це значно пришвидшує роботу, коли ви маєте велику кількість каналів (100 і більше). Статичний плейлист створюється (оновлюється) кожного разу,
коли автоматично оновлюються джерела каналів, або коли ви натискаєте на «Update all sources/Create static playlist» на сторінці «Sources».
Для токенів (Authentication Token) статичні плейлисти не створюються.</p>
</li>
<li>
<p>«Remove broken channels» – «TVLINK» автоматично видалятиме всі канали, які виявилися непрацездатними.
Будьте обережні з цією опцією: якщо зникне підключення до інтернету, «TVLINK» почне видаляти кожен канал, який ви будете вмикати.</p>
</li>
<li>
<p>«Authentication webUI» – проста автентифікація (логін/пароль) для веб-інтерфейсу. Після активації ви одразу побачите вікно для введення даних.
Вам потрібно ввести – «admin/admin». Після цього ви можете вказати свої логін та пароль у полях «Login (webUI)» та «Password (webUI)» відповідно.
Якщо в полі «Login (webUI)» ввести порожній рядок або менше ніж три символи, логін буде скинуто до значення за замовчуванням (admin).
Це стосується і поля «Password (webUI)»: порожній рядок або менше ніж три символи скинуть пароль на «admin».</p>
</li>
</ul>
<p>IP-адреси для списку «Playlist IP» беруться із системи.
Якщо вам потрібно додати IP-адресу (або доменне ім’я), якої немає в системі (наприклад, якщо «TVLINK» працює за NAT), створіть файл «ip-address.ext» у каталозі «tvlink/data».
Кожен рядок файлу повинен містити одну IP-адресу або одне доменне ім’я. Наприклад:</p>
<pre><code>100.100.100.100
200.200.200.200
my.own.server.com
</code></pre>
<h2 id="маркер-автентифікації-для-потоків-та-плейлистів">
  Маркер автентифікації для потоків та плейлистів
  <a class="anchor" href="#%d0%bc%d0%b0%d1%80%d0%ba%d0%b5%d1%80-%d0%b0%d0%b2%d1%82%d0%b5%d0%bd%d1%82%d0%b8%d1%84%d1%96%d0%ba%d0%b0%d1%86%d1%96%d1%97-%d0%b4%d0%bb%d1%8f-%d0%bf%d0%be%d1%82%d0%be%d0%ba%d1%96%d0%b2-%d1%82%d0%b0-%d0%bf%d0%bb%d0%b5%d0%b9%d0%bb%d0%b8%d1%81%d1%82%d1%96%d0%b2">#</a>
</h2>
<p align="center">
  <a href="/tvlink/settings/02.png"><img src="/tvlink/settings/02.png" width="480"/></a>
</p>
<p>Захист від несанкціонованого доступу до потоків та плейлистів.</p>
<ul>
<li>«Authentication Token» – вмикає підтримку маркерів автентифікації.</li>
<li>«Main Token for playlist/streams» – будь-яка послідовність латинських літер та/або цифр, чутлива до регістру.</li>
</ul>
<blockquote class="book-hint info">
<p>Після будь-яких змін у налаштуваннях «Токенів» необхідно застосувати налаштування («Apply Settings» внизу сторінки) або перезавантажити програму.</p>
<p>Якщо у вас увімкнена опція «Create static playlist», то після будь-яких змін у налаштуваннях «Токенів» не забудьте оновити статичні плейлисти (натисніть «Update all sources» на сторінці «Sources»).</p>
</blockquote>
<p>Якщо опцію «Authentication Token» активовано, після застосування налаштувань доступ до потоків та плейлистів здійснюватиметься лише через токен. На сторінці «Settings» задається токен для основного плейлиста.</p>
<p>Інші токени задаються у розділі 
  <a href="/uk/docs/tvlink/docs/profiles/">«Профілі користувачів»</a>.</p>
<h2 id="періодичне-перезавантаження-налаштувань">
  Періодичне перезавантаження налаштувань
  <a class="anchor" href="#%d0%bf%d0%b5%d1%80%d1%96%d0%be%d0%b4%d0%b8%d1%87%d0%bd%d0%b5-%d0%bf%d0%b5%d1%80%d0%b5%d0%b7%d0%b0%d0%b2%d0%b0%d0%bd%d1%82%d0%b0%d0%b6%d0%b5%d0%bd%d0%bd%d1%8f-%d0%bd%d0%b0%d0%bb%d0%b0%d1%88%d1%82%d1%83%d0%b2%d0%b0%d0%bd%d1%8c">#</a>
</h2>
<p align="center">
  <a href="/tvlink/settings/03.png"><img src="/tvlink/settings/03.png" width="480"/></a>
</p>
<p>Ця функція перезавантажує налаштування «TVLINK» через вказані проміжки часу. Ця дія аналогічна натисканню кнопки «Apply Settings» внизу сторінки.
Вона не перезавантажує саму програму, а лише повторно ініціює всі налаштування. Однак це сприяє очищенню оперативної пам’яті та закриттю всіх мережевих з’єднань (сокетів).
Тому ця функція може бути корисною, коли сервер працює цілодобово.</p>
<ul>
<li>«Reload by interval» – перезавантажувати модулі «TVLINK» через інтервал часу (у годинах), вказаний у параметрі «Reload every hours».</li>
<li>«Reload once a day» – перезавантажувати один раз на добу у час, визначений параметром «Reload at o’clock».</li>
</ul>
<p>Час, вказаний у цих опціях, є орієнтовним. Наприклад, якщо встановлено «Reload once a day» / «Reload at o’clock» на 4 годині, перезавантаження відбудеться між четвертою та п’ятою годинами.</p>
<p>Опція «Reload once a day» має вищий пріоритет. Якщо ви ввімкнете обидва параметри, перезавантаження модулів відбуватиметься один раз на добу.</p>
<p>Перезавантаження відбуваються лише за наступних умов:</p>
<ol>
<li>кількість відкритих мережевих з’єднань (сокетів) перевищує 10;</li>
<li>програма використовує більше ніж 60 МБ оперативної пам’яті для систем, де обсяг ОЗП менший за 1,5 ГБ, та більше ніж 120 МБ для систем, де обсяг ОЗП перевищує 1,5 ГБ;</li>
</ol>
<p>Щоб уникнути проблем із трансляцією потоків, ці функції спрацьовують лише тоді, коли «TVLINK» не веде мовлення (немає підключених клієнтів).
Перезавантаження модулів відбудеться одразу після відключення останнього клієнта.</p>
<p>Якщо ввімкнено опцію «Ignore connected clients on Reload», модулі «TVLINK» буде перезавантажено незалежно від наявності підключених клієнтів.</p>
<h2 id="empty-channel-link">
  «Empty channel link»
  <a class="anchor" href="#empty-channel-link">#</a>
</h2>
<p>Дозволяє ввести власне посилання на потік, який відтворюватиметься, якщо жодне з основних посилань на канал не працює.</p>
<h2 id="exclude-these-lines-from-channel-names-when-mapping">
  «Exclude these lines from channel names when mapping»
  <a class="anchor" href="#exclude-these-lines-from-channel-names-when-mapping">#</a>
</h2>
<p>Виключення слів із назв каналів. Ви можете виключити будь-які рядки з назви каналу для автоматичного зв’язування.
Сама назва каналу при цьому залишається незмінною, проте «TVLINK» під час автоматичного зв’язування відкидатиме вказану вами частину з назви.
Роздільником слів, які потрібно виключити з назви, є кома (без пробілів).
Наприклад, при таких налаштуваннях усі канали з такими іменами вважатимуться одним і тим самим каналом – «Discovery Science HD».</p>
<pre><code>«Discovery Science HD»
«Discovery Science HD orig»
«Discovery Science HD PREMIUM+»
</code></pre>
<p align="center">
  <a href="/tvlink/settings/04.png"><img src="/tvlink/settings/04.png" width="480"/></a>
</p>
<blockquote class="book-hint info">
<p>Якщо в одному джерелі є канали, як показано вище, то найвищий пріоритет матиме потік (посилання на потік), назва якого найдовша,
тобто спочатку «Discovery Science HD PREMIUM+», потім «Discovery Science HD orig» і останнім «Discovery Science HD».</p>
</blockquote>
<h2 id="m3u-playlist-settings">
  «M3U playlist settings»
  <a class="anchor" href="#m3u-playlist-settings">#</a>
</h2>
<p>Дозволяє додати потрібні вам елементи після тегів «EXTM3U» та «EXTINF» у плейлісті «TVLINK».
Наприклад, це може бути інформація для періодичного оновлення списку каналів: «refresh=&ldquo;3600&rdquo;». За умови, що ваш IPTV програвач це підтримує.</p>
<h2 id="налаштування-потоків">
  Налаштування потоків
  <a class="anchor" href="#%d0%bd%d0%b0%d0%bb%d0%b0%d1%88%d1%82%d1%83%d0%b2%d0%b0%d0%bd%d0%bd%d1%8f-%d0%bf%d0%be%d1%82%d0%be%d0%ba%d1%96%d0%b2">#</a>
</h2>
<p align="center">
  <a href="/tvlink/settings/05.png"><img src="/tvlink/settings/05.png" width="480"/></a>
</p>
<ul>
<li>«Main User-Agent» – задає User-Agent за замовчуванням. У деяких IPTV-провайдерів може бути блокування за User-Agent.
Вони надають потік лише якщо запит надходить від визначеної програми. Ви можете вказати «TVLINK», щоб він видавав себе за іншу програму.</li>
</ul>
<p>Наступні налаштування здебільшого стосуються модуля «Streamlink» і відповідають за роботу з потоками.</p>
<ul>
<li>
<p>«Stream Ring buffer» – задає розмір буфера для потоків (у мегабайтах).
Відповідає параметру <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-ringbuffer-size">«ringbuffer-size»</a> в «Streamlink».</p>
</li>
<li>
<p>«Chunk size» – задає розмір фрагмента під час читання потоку (у байтах). Чим більший розмір фрагмента, то менше навантаження на процесор.
Чим менший розмір фрагмента, тим швидше відкривається потік.</p>
</li>
<li>
<p>«Threads job timeout» – час (у секундах), через який буде припинено роботу ланцюжка з читання/запису фрагментів потоку.
Частково відповідає параметру <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-stream-timeout">«stream-timeout»</a> у «Streamlink».</p>
</li>
<li>
<p>«General HTTP timeout Connect/Data» – загальний тайм-аут (у секундах), який використовується для всіх HTTP-запитів, окрім тих, що охоплюються іншими параметрами.
Для розуміння: в HLS-потоках це буде тайм-аут для отримання списку сегментів. Окремо встановлюється час (тайм-аут) для підключення та час на отримання даних відповідно.
Відповідає параметру <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-http-timeout">«http-timeout»</a> у «Streamlink»,
окрім того, що дає змогу встановити різні значення для з’єднання та читання даних.</p>
</li>
<li>
<p>«HLS segment timeout Connect/Data» – тайм-аут (у секундах), який використовується для HLS-сегментів (а також DASH тощо).
Окремо встановлюється час (тайм-аут) для підключення та час на отримання даних відповідно.
Відповідає параметру <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-stream-segment-timeout">«stream-segment-timeout»</a> у «Streamlink»,
окрім того, що дає змогу встановити різні значення для з’єднання та читання даних.</p>
</li>
<li>
<p>«HLS segment queue threshold» – коефіцієнт множення цільової тривалості списку відтворення HLS, після якого потік буде зупинено достроково,
якщо після оновлення списку відтворення до черги не буде додано нових сегментів.
Відповідає параметру <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-hls-segment-queue-threshold">«hls-segment-queue-threshold»</a> у «Streamlink».</p>
</li>
<li>
<p>«Stream retry count» – ця опція встановлює параметри <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-stream-segment-attempts">«stream-segment-attempts»</a>
та <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-hls-playlist-reload-attempts">«hls-playlist-reload-attempts»</a> для «Streamlink».
Тобто кількість спроб завантаження для сегментів та списку сегментів.</p>
</li>
<li>
<p>«Segment threads» – кількість паралельних завантажень сегментів. Це розмір пулу потоків, який використовується для завантаження сегментів.
Відповідає параметру <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-stream-segment-threads">«stream-segment-threads»</a> у «Streamlink».</p>
</li>
<li>
<p>«Segments Queue» – розмір черги сегментів. У «Streamlink» вона є сталою – 20 сегментів. Але це забагато для Live-потоків.
Чим менша черга, тим скоріше закриватимуться потоки, а також буде менше споживання оперативної пам’яті та кількості відкритих сокетів.
Краще встановити «as threads», тобто відповідає кількості «Segment threads», але не менше ніж 6 сегментів.</p>
</li>
<li>
<p>«HLS live edge» – задає, скільки HLS-сегментів потрібно завантажити під час старту потоку.
Відповідає параметру <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-hls-live-edge">«hls-live-edge»</a> у «Streamlink».</p>
</li>
<li>
<p>«HLS playlist reload time» – контролює час, через який виконується запит для оновлення списку сегментів.
Частково відповідає параметру <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-hls-playlist-reload-time">«hls-playlist-reload-time»</a> у «Streamlink».
Параметр «segment» має таке ж значення, як і в «Streamlink». Значення «duration» відповідає «default» у «Streamlink». Значення «average» – це середній час двох сегментів.
Значення «default» – це або одне зі значень, яким відповідають «duration» / «segment», або, якщо їх немає, встановлено час – 6 секунд.</p>
</li>
<li>
<p>«HLS Stream Data» – якщо активовано, негайно передає дані із сегмента до вихідного буфера під час завантаження. Канали відкриваються швидко, без попередньої буферизації перед стартом.
Якщо вимкнено, дані передаються лише після завантаження першого сегмента.
Відповідає параметру <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-hls-segment-stream-data">«hls-segment-stream-data»</a> у «Streamlink».</p>
</li>
<li>
<p>«HLS Live Restart» – якщо активовано, переходити до початку прямої трансляції або якомога далі назад.
Відповідає параметру <a target='_blank' href="https://streamlink.github.io/cli.html#cmdoption-hls-live-restart">«hls-live-restart»</a> у «Streamlink».</p>
</li>
<li>
<p>«Debug Streams» – додає журнал роботи модуля «Streamlink» до журналу роботи «TVLINK». Файл журналу роботи знаходиться в каталозі «tvlink/log».</p>
</li>
<li>
<p>«Sources Proxy» та «Streams Proxy» – дозволяють встановити проксі для джерел та потоків. Формат: «http://login:password@your.proxy:port».
Значення «login/password» необов’язкові. Підтримуються протоколи: http, https, socks5.</p>
</li>
</ul>
<h2 id="налаштування-потоків-для-окремих-джерел">
  Налаштування потоків для окремих джерел
  <a class="anchor" href="#%d0%bd%d0%b0%d0%bb%d0%b0%d1%88%d1%82%d1%83%d0%b2%d0%b0%d0%bd%d0%bd%d1%8f-%d0%bf%d0%be%d1%82%d0%be%d0%ba%d1%96%d0%b2-%d0%b4%d0%bb%d1%8f-%d0%be%d0%ba%d1%80%d0%b5%d0%bc%d0%b8%d1%85-%d0%b4%d0%b6%d0%b5%d1%80%d0%b5%d0%bb">#</a>
</h2>
<p align="center">
  <a href="/tvlink/settings/06.png"><img src="/tvlink/settings/06.png" width="480"/></a>
</p>
<p>Такі налаштування потоків, як:</p>
<ul>
<li>Threads job timeout</li>
<li>General HTTP timeout</li>
<li>HLS segment timeout</li>
<li>HLS segment queue threshold</li>
<li>Stream retry count</li>
<li>HLS live edge</li>
<li>HLS Stream Data</li>
<li>HLS Live Restart</li>
</ul>
<p>можна встановити окремо для кожного джерела на сторінці «Sources» (іконка біля назви джерела). При цьому не потрібно натискати на «Apply Settings», зміни набувають чинності одразу.</p>
<p>Ці самі параметри не потребують перезавантаження і на сторінці «Settings».</p>
<p>Кнопка «Default» у формі «Streamer settings» повертає всі окремі налаштування потоків для джерела до основних налаштувань на сторінці «Settings».</p>
<ul>
<li>
<p>Playlist URL – дає можливість змінити URL-адресу джерела.</p>
</li>
<li>
<p>User-Agent – дає можливість встановити опцію «User-Agent» для кожного джерела (потоків у цьому джерелі) окремо. Підміняє собою опцію «Main User-Agent».</p>
</li>
<li>
<p>«Disable load icons» — вимикає отримання іконок каналів із джерела. На деяких джерелах можуть бути вказані недійсні адреси іконок.
Це призводить до затримки (залежить від вашого браузера) відображення списків каналів у веб-інтерфейсі програми.</p>
</li>
<li>
<p>«Repeat source streams» — дозволяє встановити кількість повторів програвання потоку під час збоїв. Ця опція не має стосунку до Streamlink-опції «Stream retry count».
Значення «always» означає, що повтори не обмежені, «0» — функцію вимкнено (за замовчуванням), інші значення — це кількість повторів.</p>
</li>
</ul>
<blockquote class="book-hint info">
<p>Якщо ваш канал має лише один потік і цей потік хоч якось працює, «TVLINK» нескінченно намагатиметься перезапустити цей потік.
Функція «Repeat source streams» робить те саме для джерела (потоку цього джерела) каналу, де більше ніж один потік.
Таким чином, переключення на наступний потік цього каналу відбудеться за умови: або потік зовсім перестав працювати,
або за вибраною вами кількістю повторів. Якщо вибрано «always» — то тільки якщо потік перестав хоч щось віддавати.</p>
</blockquote>
<p>Зміни в налаштуваннях цих полів відбуваються одразу після втрати фокуса.</p>
<h2 id="пояснення-щодо-налаштування-роботи-потоків">
  Пояснення щодо налаштування роботи потоків
  <a class="anchor" href="#%d0%bf%d0%be%d1%8f%d1%81%d0%bd%d0%b5%d0%bd%d0%bd%d1%8f-%d1%89%d0%be%d0%b4%d0%be-%d0%bd%d0%b0%d0%bb%d0%b0%d1%88%d1%82%d1%83%d0%b2%d0%b0%d0%bd%d0%bd%d1%8f-%d1%80%d0%be%d0%b1%d0%be%d1%82%d0%b8-%d0%bf%d0%be%d1%82%d0%be%d0%ba%d1%96%d0%b2">#</a>
</h2>
<p>Спочатку визначимо відмінності між тайм-аутами з’єднання та читання даних (Connect timeout і Read Data timeout).</p>
<ul>
<li>«Connect timeout» (час очікування підключення)</li>
</ul>
<p>Коли клієнт (у цьому випадку TVLINK є клієнтом по відношенню до сервера, звідки він запитує потоки) ініціалізує з’єднання, він повинен отримати відповідь від сервера (спеціальний код відповіді).
Не має значення, якою саме буде відповідь сервера. Це може бути відповідь 200 (підключення встановлено), 302 (переадресація) або будь-яка інша, головне, щоб сервер відповів.
Якщо протягом часу, зазначеного в тайм-ауті з’єднання (часі очікування підключення), відповідь від сервера не надійде, клієнт розриває з’єднання.</p>
<ul>
<li>«Read Data timeout» (час очікування читання даних)</li>
</ul>
<p>Коли клієнт отримує відповідь 200 (підключення встановлено) від сервера, він починає завантажувати (читати) дані, які передає сервер.
Якщо протягом часу, вказаного в тайм-ауті читання даних (часі очікування читання даних), сервер не передасть інформацію, клієнт розриває з’єднання.</p>
<p>Тепер визначимося з форматами потоків.</p>
<p>Найбільш поширені з них: TS та HLS.</p>
<ul>
<li>«TS»</li>
</ul>
<p>По суті, це те саме, якби ви завантажували будь-який файл у браузері. Клієнт робить запит і, якщо отримує відповідь 200, просто послідовно отримує дані.
Дані передаються в одному потоці, і якщо виникають проблеми з трафіком, це спричиняє проблеми і з відтворенням відео.
Тобто для IPTV через інтернет це не найкраще рішення. Воно більше підходить для локальної мережі.</p>
<ul>
<li>«HLS»</li>
</ul>
<p>Це той самий «TS» (спрощено кажучи), але розрізаний на фрагменти (сегменти).
Завдяки тому, що ці сегменти є вже записаними файлами (на відміну від TS, які передаються в реальному часі) і їх є кілька, клієнт має можливість одночасно завантажувати декілька сегментів.
Це, своєю чергою, допомагає боротися з проблемами трафіку і, відповідно, краще підходить для IPTV через інтернет.</p>
<p>Тепер безпосередньо про параметри «TVLINK».</p>
<ul>
<li>«General HTTP timeout Connect/Data»</li>
</ul>
<p>Якщо у вас TS-потік, саме ці тайм-аути будуть застосовуватися. Тайм-аути «HLS segment» не використовуватимуться для таких потоків.
Якщо у вас HLS-потік, тайм-аути «General HTTP» працюватимуть під час отримання плейлистів зі списком сегментів або варіантів якості потоків
(провайдер може надавати кілька варіантів якості потоків для різних швидкостей з’єднання). Плейлистами ми називаємо текстові файли,
які містять посилання на інші плейлисти (наприклад, якщо це список якості потоків) або посилання на відеосегменти.</p>
<ul>
<li>«HLS segment timeout Connect/Data»</li>
</ul>
<p>Ці тайм-аути застосовуються безпосередньо до сегментів (відеофайлів). Хоча в назві цього параметра зазначено «HLS», ці тайм-аути також працюють з іншими форматами сегментованих потоків, наприклад, «DASH».</p>
<p>У простому випадку (без списку якості потоків) для HLS-потоків це виглядатиме так:</p>
<ul>
<li>отримання списку сегментів – «General HTTP timeout»</li>
<li>завантаження сегмента 1 – «HLS segment timeout»</li>
<li>завантаження сегмента 2 – «HLS segment timeout»</li>
<li>завантаження сегмента 3 – «HLS segment timeout»</li>
<li>отримання нового списку сегментів – «General HTTP timeout»</li>
<li>завантаження сегмента 4 – «HLS segment timeout»</li>
<li>завантаження сегмента 5 – «HLS segment timeout»</li>
<li>завантаження сегмента 6 – «HLS segment timeout»</li>
<li>отримання нового списку сегментів – «General HTTP timeout»</li>
</ul>
<p>і так далі…</p>
<ul>
<li>«HLS segment queue threshold»</li>
</ul>
<p>Цей параметр (тайм-аут) також належить до HLS-потоків. Список HLS-сегментів (плейлист) містить змінну, де вказано тривалість відео в сегменті.
Ця змінна використовується «TVLINK» для визначення часу, через який потрібно запросити новий файл сегментів. Сервер постійно оновлює цей список одразу після завершення запису нового сегмента.
«HLS segment queue threshold» це число, на яке помножується змінна тривалості сегмента. Якщо протягом часу, отриманого в результаті множення, список сегментів на сервері не оновиться, клієнт розірве з’єднання.
Наприклад, у списку зазначено, що тривалість сегмента становить 6 секунд. Якщо значення «HLS segment queue threshold» дорівнює трьом, клієнт розірве з’єднання через 18 секунд, якщо на сервері не з’явиться новий сегмент.</p>
<ul>
<li>«Threads job timeout»</li>
</ul>
<p>Це тайм-аут внутрішнього циклу «Streamlink», який зчитує дані з вхідного потоку та записує їх у вихідний потік.
Якщо протягом зазначеного часу через цикл не проходять дані, він припиняє роботу, що призводить до закриття будь-якого з’єднання.</p>
<ul>
<li>«Stream retry count»</li>
</ul>
<p>Це кількість повторних спроб з’єднання у разі спрацьовування тайм-аутів «General HTTP» та «HLS segment».</p>
<h2 id="ffmpeg-transcode-stream">
  FFmpeg transcode stream
  <a class="anchor" href="#ffmpeg-transcode-stream">#</a>
</h2>
<p>Якщо у вашій системі встановлено «FFmpeg», ви маєте можливість увімкнути модуль «FFmpeg transcode stream».</p>
<p align="center">
  <a href="/tvlink/settings/07.png"><img src="/tvlink/settings/07.png" width="480"/></a>
</p>
<p>Опції – це параметри командного рядка FFmpeg. Призначення полів:</p>
<ul>
<li>«Before input» – параметри для апаратного транскодування</li>
<li>«Video encoder» – параметри відеокодера</li>
<li>«Audio encoder» – параметри аудіокодера</li>
</ul>
<p>Щоб було зрозуміло, як саме ці параметри будуть вставлені в командний рядок «FFmpeg», ось приклад (спрощена схема):</p>
<pre><code>/usr/bin/ffmpeg -err_detect ignore_err -stream_loop -1 [Before input] -i http://channel.stream -c:v [Video encoder] -c:a [Audio encoder] -ignore_unknown -map 0:v -map 0:a -f mpegts
</code></pre>
<p>За замовчуванням поля «Video encoder» та «Audio encoder» містять параметр “copy”. Тобто якщо ці поля залишаються порожніми, буде встановлено значення “copy” (пропускати потік без перекодування).</p>
<p>Перед тим як встановлювати значення, переконайтеся, що «FFmpeg» у вашій системі підтримує відповідні параметри. Наприклад, виконайте команду:</p>
<pre><code>ffmpeg -hide_banner -encoders
</code></pre>
<p>щоб переглянути доступні аудіо- та відеокодери.</p>
<p>Якщо процесор у вашій системі (наприклад, Intel Pentium N5000) підтримує апаратне кодування потоків, можна застосувати, наприклад, такі налаштування.</p>
<p>«Before input»:</p>
<pre><code>-hwaccel vaapi -hwaccel_output_format vaapi -hwaccel_device /dev/dri/renderD128
</code></pre>
<p>«Video encoder»:</p>
<pre><code>h264_vaapi -r 50
</code></pre>
<p>«Audio encoder»:</p>
<pre><code>aac -b:a 96k
</code></pre>
<p>Після застосування налаштувань («Apply Settings»), на сторінці «About» з’явиться посилання на «M3U FFmpeg Playlist» (формат: http://ip-address:port/ffmpeglist).</p>
<p align="center">
  <a href="/tvlink/settings/09.png"><img src="/tvlink/settings/09.png" width="480"/></a>
</p>
<p>Увімкнення «FFmpeg transcode stream» не впливає на основний модуль трансляції. Вони працюють паралельно. Ви можете одночасно підключати одних клієнтів до звичайного плейлиста (playlist),
а інших – до плейлиста «FFmpeg» (ffmpeglist).</p>
<blockquote class="book-hint info">
<p>За посиланням «http://ip-address:port/ffmpeglist» ви завжди можете отримати плейлист, навіть якщо «FFmpeg transcode stream» вимкнено і в системі немає «FFmpeg». Тому будьте уважні.</p>
</blockquote>
<p>Якщо увімкнути «Debug Streams» та запустити «TVLINK» з командного рядка, при зупинці потоку буде виведено інформацію від «FFmpeg» (параметри кодування, помилки тощо).</p>
<h2 id="оновлення-epg">
  Оновлення EPG
  <a class="anchor" href="#%d0%be%d0%bd%d0%be%d0%b2%d0%bb%d0%b5%d0%bd%d0%bd%d1%8f-epg">#</a>
</h2>
<p align="center">
  <a href="/tvlink/settings/08.png"><img src="/tvlink/settings/08.png" width="480"/></a>
</p>
<p>Ці налаштування відповідають за періодичне оновлення «EPG».</p>
<ul>
<li>
<p>«Auto update EPG» – увімкнути/вимкнути автоматичне періодичне оновлення EPG.</p>
</li>
<li>
<p>«Update period EPG» – вибрати зі списку період оновлення в годинах або один раз на добу (вночі).</p>
</li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#налаштування-сервера">Налаштування сервера</a></li>
        <li><a href="#маркер-автентифікації-для-потоків-та-плейлистів">Маркер автентифікації для потоків та плейлистів</a></li>
        <li><a href="#періодичне-перезавантаження-налаштувань">Періодичне перезавантаження налаштувань</a></li>
        <li><a href="#empty-channel-link">«Empty channel link»</a></li>
        <li><a href="#exclude-these-lines-from-channel-names-when-mapping">«Exclude these lines from channel names when mapping»</a></li>
        <li><a href="#m3u-playlist-settings">«M3U playlist settings»</a></li>
        <li><a href="#налаштування-потоків">Налаштування потоків</a></li>
        <li><a href="#налаштування-потоків-для-окремих-джерел">Налаштування потоків для окремих джерел</a></li>
        <li><a href="#пояснення-щодо-налаштування-роботи-потоків">Пояснення щодо налаштування роботи потоків</a></li>
        <li><a href="#ffmpeg-transcode-stream">FFmpeg transcode stream</a></li>
        <li><a href="#оновлення-epg">Оновлення EPG</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












