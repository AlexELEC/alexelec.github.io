[{"id":0,"href":"/uk/posts/dvbt2-to-iptv/","title":"Сервер трансляції «DVB-T2 to IPTV»","section":"Новини","content":" Задачі які ми ставимо. # Задачі які ми ставимо.\nМи будемо приймати «DVB-T2» сигнал на USB-тюнер який підключено до комп’ютера з системою «LibreELEC (ae-fork)» за допомогою програми «MuMuDVB». Цю програму (MuMuDVB) ми налаштуємо так щоб вона видавала потоки в HLS-форматі.\nМи налаштуємо простий HTTP-сервер (httpd), для того щоб у нас була можливість отримувати HLS-потоки каналів за допомогою «TVLINK», або будь-якого іншого IPTV-програвача.\nНарешті, ми добавимо ці потоки в «TVLINK» і зробимо деякі налаштування для них.\nЧому саме ми хочемо отримати потоки в HLS-форматі:\nканали будуть перемикатися дуже швидко це набагато надійніше, з точки зору передачі даних, чим в TS-форматі. А отже ми маємо стабільні трансляції\nВибір обладнання. # При написанні цієї інструкції використовувався USB-тюнер «Astrometa DVB-T2». Напевно, це самий дешевий пристрій на ринку (коштує біля 16$) і дуже добре підходить для цієї задачі.\nЯк Ви розумієте, для того щоб транслювати одразу всі доступні Т2-канали, вам знадобиться стільки тюнерів, скільки частот транслюються в вашій місцевості. Наприклад, в Києві транслюються чотири Т2-частоти (514, 538, 554 та 698 МГц), а отже щоб прийняти одразу всі частоти знадобиться 4 окремих USB-тюнери. Звісно, ви можете транслювати тільки одну частоту (це приблизно 8 каналів), якщо у вас тільки один тюнер. Також зверніть увагу, чи є в вашому комп’ютері достатня кількість USB-портів. Якщо ні, то можна використати активний (із зовнішнім живленням) USB-хаб.\nЗауважте: якщо ви збираєтесь підключити декілька тюнерів, подбайте про те, щоб це були тюнери однієї і тієї ж самої моделі. Якщо це будуть різні тюнери (наприклад: «Astrometa DVB-T2» і «GENIATECH MyGica Т2»), ви можете зіткнутися з проблемою. А саме: при перезавантаженні система може міняти номери адаптерів. І якщо таке стається, то файл конфігурації який ви зробили для «Astrometa» починає використовується для тюнера «MyGica», тоді і виникають проблеми. В цьому випадку прийдеться робити «прив’язку» тюнерів до імен за допомогою «udev symlink», або вирішувати проблему в інший спосіб.\nНалаштування «MuMuDVB». # Спершу давайте подивимося, чи правильно визначила система наш DVB-адаптер/адаптери і завантажила потрібні драйвери.\nЗа допомогою «PuTTY» під’єднуємося до терміналу системи. Нагадаю:\nlogin – «root» password – «mcpc». Вводимо команду «mc» (це файловий менеджер Midnight Commander) і дивимося каталог «/dev/dvb». Якщо в системі не має такого каталогу, це зазвичай означає що в системі відсутні потрібні драйвери. В моєму випадку (підключений тільки один тюнер Astrometa) це виглядає так.\nimg\nЯк бачите, тюнер «Astrometa DVB-T2» має два фронтєнда (frontend0 і frontend1), а отже адаптер визначився системою вірно. За приймання Т2 сигналу відповідає «frontend1», ця інформація нам знадобиться пізніше.\nТепер налаштуємо конфігураційний файл для запуску «MuMuDVB».\nПід’єднаємося до системи з допомогою «WinSCP», так простіше редагувати файли. В каталозі «/storage/.config/mumudvb» уже є всі потрібні файли і приклади. Відкрийте і налаштуйте під себе файл «Kyiv-t2.conf» (потім ви можете змінити його назву). Подивимося параметри які задіяні в цьому файлі. Детальний опис всіх параметрів для «MuMuDVB» ви можете побачити тут.\nunicast – активуємо одноадресну передачу HTTP port_http – порт прослуховування для unicast а також порт Web-інтерфейса card – номер адаптера tuner – номер фронтєнда delivery_system – система доставки може бути: DVBT, DVBT2, DVBS, DVBS2 і тд. freq – частота транспондера multicast_ipv4 – вимикаємо групову передачу IPv4, вона нам не потрібна autoconfiguration – дозволяє визначити всі канали та їх параметри автоматично autoconf_scrambled – вважаємо закодовані канали дійсними під час автоконфігурації hls – вмикаємо HLS формат hls_rotate_count – кількість фрагментів HLS у плейлисті hls_rotate_time – тривалість фрагментів HLS у секундах hls_storage_dir – каталог в якому будуть зберігатися фрагменти HLS і плейлисти Розглянемо параметри які обов’язково потрібно змінити для інших файлів конфігурації, якщо ви використовуйте декілька тюнерів.\nport_http – якщо в першому файлі у вас стояло значення «4242», в наступній конфігурації зробіть «4243» і так далі. Не обов’язково встановлювати саме такі значення, але порти в різних конфігураціях повинні бути різні. card – значення (adapter) в жодній конфігурації не повинні повторюватись якщо ми маємо справу з USB-адаптерами про які згадується у цій інструкції. tuner – номер тюнера (frontend) для «Astrometa DVB-T2» потрібно вказати «1» якщо ви хочете приймати DVB-T2 сигнал. Фронтєнд «0» це для DVB-T. freq – частоти повинні бути різні. Навіщо приймати ті самі канали на декілька адаптерів. autoconf_scrambled – тут ми нічого не міняємо (скрізь стоїть 1), просто хочу пояснити. Якщо вимкнути цей параметр то «MuMuDVB» може не знайти канали. Хоча самі канали не закодовані, можливо програма бачить якийсь параметр в потоці що вказує на кодування. hls_playlist_name – назва основного плейлиста (плейлист зі списком каналів). Цього параметра немає в прикладі, але це важливий параметр якщо у вас декілька адаптерів. В кожній конфігурації вам потрібно вказати різні назви (в hls_playlist_name), тому що всі HLS-файли у нас будуть в одному каталозі. Наприклад ми можемо зробити назви в різних конфігураціях по частотах:\nhls_playlist_name=514. m3u8 hls_playlist_name=538. m3u8 і так далі.\nТепер давайте перевіримо як працює «MuMuDVB» с вашою конфігурацією.\nБудемо вважати, що у вас підключена і налаштована антена.\nВведіть в терміналі команду:\nmumudvb -d -c /storage/.config/mumudvb/Kyiv-t2.conf img\nОпис параметрів «MuMuDVB» ви можете подивитись тут.\nВи можете зайти у веб-інтерфейс «http://your-ip:your-port» (наприклад: «http://192.168.1.72:4242») і перевірити як все працює.\nimg\nВ каталозі «/tmp/mumudvb» або в іншому, який ви вказали в «hls_storage_dir», ви повинні побачити HLS-файли.\nimg\nВи можете перевірити як працюють канали будь яким IPTV плеєром (наприклад VLC), але поки що це будуть TS-потоки. Щоб отримати HLS-трансляції нам потрібно налаштувати HTTP-сервер.\nТепер налаштуємо сервіс/сервіси для автоматичного запуску «MuMuDVB».\nСкопіюйте файл «/storage/.config/mumudvb/mumudvb.service» в каталог «/storage/.config/system.d».\nЯкщо у вас декілька адаптерів, зробіть це для кожного із них, звісно з різними іменами. Наприклад:\nmumudvb1.service mumudvb2.service і тд.\nВідредактуйте в цих файлах рядок:\nExecStart=/storage/.config/mumudvb/mumudvb.run 0 1 \u0026quot;Kyiv-t2.conf\u0026quot; А саме, три останні параметри. Де:\n0 – номер адаптера 1 – номер фронтєнда Kyiv-t2.conf – назва файлу конфігурації Після цього можна запустити і активувати сервіс/сервіси:\nsystemctl start mumudvb1 systemctl start mumudvb2 systemctl enable mumudvb1 systemctl enable mumudvb2 Налаштування HTTP сервера. # Як згадувалось раніше, для того щоб мати можливість дивитись HLS-трансляції, нам потрібен HTTP-сервер. Ми будемо використовувати простий «httpd».\nФайл «/storage/.config/mumudvb/httpd.conf» це конфігурація нашого HTTP-сервера. Там є довідка і він уже налаштований. Якщо ви змінили каталог в параметрі «hls_storage_dir» тоді відредактуйте рядок (замініть на ваш каталог):\nH:/tmp/mumudvb Скопіюйте файл «/storage/.config/mumudvb/httpd.service» в каталог «/storage/.config/system.d». Запустіть і активуйте сервіс:\nsystemctl start httpd systemctl enable httpd Тепер, в залежності від того яку назву мають ваші плейлисти (параметр «hls_playlist_name») ви можете отримати трансляції в HLS-форматі. У моїй конфігурації використовується назва за замовчуванням, отже плейлист буде за адресою «http://192.168.1.72/playlist.m3u8».\nНалаштування «TVLINK». # Нам знадобиться «TVLINK» не нижче версії 4.0.2, який може обробляти HLS-плейлисти від «MuMuDVB».\nДодаєм плейлист (або плейлисти) і канали.\nimg\nВ налаштуваннях потоків для цього джерела ввімкніть параметри «HLS Stream Data» і «HLS Live Restart».\nimg\nПерший гарантує швидке перемикання каналів. Другий вмикати не обов’язково, але в нашому випадку «TVLINK» дуже швидко скачає всі сегменти і буде часто перевіряти наявність нових. А це трохи сповільнить його.\n"},{"id":1,"href":"/uk/posts/openwrt-install/","title":"OpenWRT: встановлення системи","section":"Новини","content":" OpenWRT: простий спосіб встановлення системи для архітектури х86-64. # На сайті «OpenWRT» описано доволі складний спосіб встановлення цієї системи навіть для підготовленого користувача. В цій інструкції розповідається як це зробити простіше.\nСтворення завантажувальної USB-флешки буде відбуватися в системі «Windows».\nНам знадобиться USB-флешка об’ємом від 8Гб. Проміжною системою (з якої буде встановлюватися OpenWRT) я вибрав Ubuntu 24.04, а її образ займає приблизно 6 Гб. Звідси і розмір флешки. Як і рекомендують самі розробники Ubuntu, образ «ubuntu-24.04-desktop-amd64.iso» записуємо на флеш-накопичувач за допомогою «balenaEtcher».\nПісля цього, в програмі «MiniTool Partition Wizard», не задіяну область флешки (повний об’єм якої складає 8Гб), відформатуйте у FAT32 та вкажіть назву розділу «Data».\nimg\nСкопіюйте розпакований образ останньої стабільної версії OpenWRT для x86-64. На цей момент такою є «openwrt-23.05.3-x86-64-generic-ext4-combined-efi.img».\nimg\nНа цьому етап підготовки закінчено.\nВставляємо флешку в комп’ютер на який ми хочемо встановити «OpenWRT», змінюємо порядок завантаження в BIOS і завантажуємося в «Ubuntu». Як Ви, напевно знаєте, «Ubuntu» за замовчуванням завантажується в режимі LiveCD. Після того як з’явиться робочий стіл закрийте вікно «Welcome to Ubuntu».\nimg\nПерше, що я рекомендую зробити, це запустити програму «GParted» і видалити всі розділи на внутрішньому HDD або SSD-диску (на тому, куди ми будемо ставити OpenWRT). Не забувайте застосовувати зміни. На зображенні нижче, встановлення буде відбуватися на SSD-диск об’ємом 256 Гб.\nimg\nВідкриваємо розділ нашої флешки (ми назвали його «Data» при створенні) де лежить образ OpenWRT і в контекстному меню файлу «Open with…» вибираємо «Disk Image Writer». В опції «Destination» вказуємо наш диск і тиснемо «Start Restoring…».\nimg\nЗнову відкриваємо «GParted».\nВ моїй системі, на цьому етапі, «GParted» завжди видає два попередження.\nimg\nНа першому натисніть «ОК», на другому «Fix».\nРозширюємо розділ «/dev/sda2» на весь обсяг нерозміченого простору. Справа в тому, що OpenWRT не має власного інсталятора, а «root» розділ після запису образу становить близько 100Мб. Решта місця на диску не задіяна.\nimg\nЗверніть увагу. Щоб все пройшло добре, потрібно зменшити новий розмір розділу (New size) на 1MiB. Без цього «GParted» у мене видавав помилку.\nЩе раз: не забувайте застосовувати зміни!\nНа цьому встановлення OpenWRT закінчено. Можете перезавантажити систему та налаштовувати мережу. За замовчуванням LAN-інтерфейс в OpenWRT має адресу «192.168.1.1», пароль для «root» не встановлений (залиште це поле порожнім при вході в веб-інтерфейс).\nimg\n"},{"id":2,"href":"/uk/posts/rc-hid/","title":"Настройка HID-пульта ДУ","section":"Новини","content":" Настройка HID-пульта ДУ в CoreELEC/LibreELEC. # Речь идет о пультах, которые распознаются системой как клавиатура (HID-пульт) и работают по радио интерфейсу. Обычно, большинство кнопок на таких пультах работают по умолчанию. Но некоторые кнопки могут либо совсем не работать, либо выполняют не то действие, которое нам нужно.\nЛично я испробовал несколько моделей таких пультов и остановился на «G20S PRO» (USB 2.4G + Backlit). Пульт с подсветкой кнопок, но без Bluetooth. Этот мне понравился больше других.\nЕдинственное неудобство, что после выключения системы пульт засыпает. Это экономит заряд батареек, но при следующем включении нужно раза три нажать какую-либо кнопку чтобы пульт проснулся.\nНастраивать пульт будем с помощью сервиса «HID-Remote» и утилиты «hid_mapper». Все настройки находятся в каталоге «/storage/.config/hid_remote/». Дальше, пути файлов отталкиваются от этого каталога.\nДля пульта «G20S PRO» (и для некоторых других) в системе уже есть конфигурация. Вам нужно только заменить содержимое файла «remote.map» на то что находится в файле «sample/Gi20sPRO.map» и прописать в файле «device.conf» переменные «MANUFACTURER и PRODUCT». Значение для них также есть в файле «sample/Gi20sPRO.map». После этого останется только включить «HID-Remote».\nЕще следует отметить, что не нужно настраивать все кнопки пульта. Обучайте только те, которые не работают или работают не так как Вы хотите. Например, если Вы посмотрите на содержимое файла «Gi20sPRO.map», то увидите, что там настроено только четыре кнопки. Кнопка «OK» которая не работала, а действие трех остальных просто переопределены. Формат файла «remote.map»:\nКод_кнопки_пульта:имя_кнопки_клавиатуры В файле «sample/keys.sample» Вы найдете все нужные имена кнопок клавиатуры.\nЧтобы ускорить процесс обучения пульта (на обучать все кнопки, а только нужные) Вы можете отредактировать файл «sample/kodi-learn.map» удалив из него лишние строки. Например, если Вам нужно обучить только кнопки «OK» и «Power» оставьте в этом файле строки:\n00:KEY_ENTER 00:KEY_S «OK» у нас будет соответствовать клавише «KEY_ENTER», а «Power» будет вызывать «Shutdown menu», за что отвечает клавиша «S» в Kodi. Все остальные строки удалите и после этого запускайте «remote-learn».\nУпоминание об этом есть в инструкции, но еще раз напомню. При активации сервиса «HID-Remote», сервис «Eventlircd» будет отключен. Это сделано для предотвращения эффекта «двойного срабатывания кнопки пульта».\nHID-Remote — настройка USB HID пультов дистанционного управления. # Как Вы знаете есть два вида пультов ДУ, которые различаются по используемым драйверам. Это так называемые «Lirc-пульты» и «HID-пульты». HID устройства отличаются (от Lirc) тем, что они эмулируют нажатия клавиш клавиатуры. По сути, для ядра Linux, эти устройства ничем не отличаются от клавиатуры. Только вот в плане настройки такого пульта обычно возникают проблемы. Это связано с тем, что одна кнопка пульта может генерировать нажатие не одной клавиши, а сразу трех или пяти. Что в свою очередь делает невозможным настройку программ под такие устройства. Тот же «Kodi» может обрабатывать нажатие максимум трех кнопок (две из которых обязательно «ctrl/shift»). Программа «hid_mapper» и сервис «HID-Remote» решают эту проблему и делают настройку HID-пультов очень простой. Стандартный «Eventlircd», который был написан еще для «OpenELEC», мне абсолютно не нравиться. Мало того, что он плохо обрабатывает комбинации клавиш, так еще эмулирует Lirc-устройство. То есть из HID-пульта делает Lirc-пульт. Но при этом теряется одно из главных достоинств HID-устройств – возможность использовать «longpress» (длинное нажатие), а также на многих кнопках возникают проблемы с «repeat» (повтор). И часто это касается именно кнопок управления звуком.\nПодведем итог:\n«Lirc-пульты» практически не выпускаются, а те что еще есть в продаже стоят довольно дорого (от 20$ и выше). «HID-пульты» есть на любой вкус и цвет и стоят они от 3$ (в среднем около 10$). Отзывчивость HID-устройств лучше, так как это по сути клавиатура. «longpress» (длинное нажатие) – огромный плюс HID-пультов, так как на одну кнопку можно назначить два действия. Настройка. Остановите «Kodi» и «Eventlircd» выполнив команды в терминале:\nsystemctl stop kodi\nsystemctl stop eventlircd\nВ файле «/storage/.config/hid_remote/device.conf» нам нужно установить значение переменных «MANUFACTURER/PRODUCT» для нашего HID-устройства. Для этого выполните команду (в файле есть подсказка):\nhid_mapper —list-devices —lookup-id\nЕсли у Вас не подключено других устройств ввода (кроме пульта) вывод будет примерно такой:\nЗдесь показано два устройства с одинаковыми значениями «Manufacturer/ Product name». Это потому, что IR-приемник обычно определяется и как клавиатура, и как мышь.\nВпишите полученные значения в «device.conf».\nMANUFACTURER=»1241″\nPRODUCT=»e000″\nТеперь нужно сказать «X-серверу» чтобы он игнорировал наш пульт. Иначе он будет перехватывать и обрабатывать нажатие кнопок, а нам это не нужно.\nИз каталога «/etc/X11» скопируйте файл, соответствующий Вашему видеоадаптеру в каталог «/storage/.config». По названию файла Вы поймете какой Вам нужен. Например, для «Intel» — это «xorg-i915.conf». В этот файл нужно добавить секцию «InputClass», пример секции находится в файле «/storage/.config/hid_remote/sample/xorg.conf.sample». Скопируйте ее и замените значение «MatchProduct» на свое. Чтобы узнать какой «MatchProduct» Вам вписать посмотрите вывод команды (поле Name):\ncat /proc/bus/input/devices\nКак видите в моем случае есть еще «HOLTEK Mouse», «HOLTEK System Control» и т.д. Для «Xorg» достаточно вписать одно слово «HOLTEK» чтобы он игнорировал все устройства где встречается это слово. Мой «xorg-i915.conf» после правок выглядит так:\nSection «Device»\nIdentifier «Device0»\nDriver «intel»\nVendorName «INTEL Corporation»\nOption «TripleBuffer» «false»\nOption «TearFree» «false»\nEndSection\nSection «InputClass»\nIdentifier «HID blacklist»\nMatchProduct «HOLTEK»\nOption «Ignore» «on»\nEndSection\nПерезагрузим «X-сервер» чтобы он принял изменения:\nsystemctl restart xorg\nи займемся обучением пульта.\nВсе просто. Запустите в терминале команду «remote-learn» и нажимайте кнопки пульта которые программа предлагает сопоставить с клавиатурными клавишами.\nНажатие «Ctrl+C» остановит обучение.\nВ итоге будет создан файл «/storage/.config/hid_remote/remote.map». Откройте его и удалите лишние строки. Если в процессе обучения Вы остановили программу – удалите строку:\nCaught SIG_TERM, exiting…\nСам файл «remote.map» создается на основе «/storage/.config/hid_remote/sample/kodi-learn.map», который Вы можете отредактировать перед тем как обучать пульт. Под редактированием, я имею ввиду: изменить кнопки клавиатуры (все значения есть в storage/.config/hid_remote/sample/keys.sample), добавить или удалить не нужные…\nПосле обучения пульта запустим «Kodi»:\nsystemctl start kodi\nи активируем сервис «HID-Remote».\nНа этом все, можно наслаждаться работой.\n"},{"id":3,"href":"/uk/docs/tvlink/docs/overview/","title":"Огляд","section":"TVLINK","content":" Загальна інформація # «TVLINK сервер» це ретранслятор та агрегатор IPTV каналів із зручним веб-інтерфейсом. Він ретранслює потоки вказані користувачем з джерел, таких як: IPTV-плейлисти, Acestream, Ministra/Stаlker Middleware або доповнення.\nГоловна мета програми, надати безперебійну роботу IPTV-каналів. Ви можете в автоматичному або ручному режимі об’єднувати потоки одного каналу з різних джерел, а «TVLINK» залежно від пріоритету джерела та його працездатності буде вибирати і ретранслювати кращий потік.\nЯкщо з якоїсь причини зупиниться трансляція попереднього потоку, програма автоматично переключиться на наступний потік цього каналу. Такий цикл буде відбуватися, поки хоч один потік із набору буде працювати.\nПрограма підтримує IPTV-архіви (catchup) з можливістю перемикання на наступний потік, навіть якщо типи архівів у цих потоках відрізняються. Для роботи цієї функції підходить будь-який IPTV-програвач із підтримкою типу архіву «Shift». Навіть якщо в такому плеєрі відсутня підтримка інших типів архіву (Append, Flussonic) він все одно буде їх відтворювати завдяки внутрішньому перетворенню типів архівів в «TVLINK».\nТакож програма надає:\nзручне налаштування та видачу EPG (програму передач у XMLTV форматі) вбудований API для самостійного написання доповнень необмежену кількість користувачів та джерел IPTV (залежить тільки від апаратного забезпечення) можливість (за допомогою профілів) надавати різні набори каналів різним користувачам редагувати (змінювати назву, вимикати, видаляти) канали, групи (по одинці або групами) сортувати, встановлювати номери для каналів та груп, встановлювати іконки для каналів можливість автоматично (за розкладом) оновлювати джерела каналів та EPG захист за допомогою «токенів» ваших канали від стороннього доступу статус роботи потоків та журнал роботи програми в веб-интерфейсі В програмі використовуються Python-модуль «Streamlink». Це, в свою чергу, дає можливість використовувати велику кількість доповнень самого «Streamlink» (ті що не потребують підтримки субмодуля «webbrowser»). Наприклад, дивитися Live-трансляції ТВ-каналів з YouTube та багато інших джерел.\n«TVLINK» може використовуватись з будь-яким IPTV програвачем, але для того щоб отримати всі переваги сервера, необхідно використовувати «PVR TVLINK Client» для «Kodi».\nОбмеження роботи програми. Програма не працює на території Росії та Білорусі. Але, якщо Ви не підтримуйте російську агресію в Україні, створіть файл «Glory_to_Ukraine» в основному каталозі «TVLINK», наприклад:\ntouch /opt/tvlink/Glory_to_Ukraine Таким чином буде вимкнена перевірка геолокації при старті програми.\nРелізи «TVLINK» компілюються тільки для «Linux». Підтримуються архітектури:\nx86-64 arm7 aarch64 Програма не потребує багато ресурсів. Наприклад, при обслуговуванні двох клієнтів в середньому займає 70 мб оперативної пам’яті.\n"},{"id":4,"href":"/uk/docs/tvlink/docs/install/","title":"Встановлення та оновлення","section":"TVLINK","content":" Встановлення # Релізи «TVLINK» компілюються тільки для «Linux».\nПрограма використовує Python-модулі «Streamlink», тому в системі повинні бути встановлені:\nPython відповідної версії. Потрібна версія «Python» вказана в описі релізу. «Runtime» залежності для «Streamlink», які ви можете бачити тут. Сам «Streamlink» встановлювати не потрібно і не бажано. Це викличне конфлікти в роботі програми. Модулі «Streamlink» є частиною «TVLINK».\nLibreELEC/CoreELEC LibreELEC/CoreELEC # Мається на увазі модифіковіні системи (ae-fork) в яких вже є всі потрібні залежності. В оригінальних ELEC–системах встановлення не можливе.\nВ налаштування системи («System» -\u0026gt; «TV Services» -\u0026gt; «TVLINK Server»), натисніть «Enable TVLINK». Програму буде встановлено і запущено автоматично.\nUbuntu/Debian Ubuntu/Debian # Пам’ятайте що в системі повинна бути встановлена відповідна версія «Python».\nДля цих систем ви можете завантажити та встановити «TVLINK» за допомогою deb-пакету. Релізи публікують тут. Після того як ви завантажили програму, введіть команди в терміналі:\napt install ./tvlink_4.1.4_amd64.deb systemctl start tvlink systemctl enable tvlink Також Ви можете встановити «TVLINK» з архіву. # В «TVLINK» використовуються утиліта «ping», встановимо її, а також деякі утиліти які нам знадобляться.\napt install -y iputils-ping tar wget Встановимо залежності для модуля «python3-streamlink». Це можна зробити однією командою:\napt install -y $(apt-cache depends python3-streamlink | grep Depends | sed \u0026quot;s/.*ends:\\ //; s/\u0026lt;.*\u0026gt;//\u0026quot; | tr '\\n' ' ') Тут команда «apt-cache depends python3-streamlink» виводить інформацію по залежностям модулів «Streamlink» , а «grep, sed, tr» роблять із неї список який передається «apt install».\nЗавантажимо та встановимо «TVLINK» (релізи програми публікуються тут).\nmkdir -p /opt/tvlink cd /opt wget https://github.com/AlexELEC/TVLINK-x86_64/releases/download/3.3.3/TVLINK-3.3.3.tar.bz2 tar -jxf TVLINK-3.3.3.tar.bz2 --directory /opt/tvlink rm -f TVLINK-3.3.3.tar.bz2 Запустимо «TVLINK» щоб перевірити:\nroot@intel:/# /opt/tvlink/tvlink — Starting TVLINK (version: 3.3.3) on 127.0.0.1:2020 / 192.168.1.33:2020 — Рекомендується зайти в веб-інтерфейс (наприклад: http://192.168.1.33:2020), додати канали і перевірити їх роботу. Помилки пов’язані з залежностями ви можете бачити тільки в терміналі, в журнал роботи «TVLINK» вони не записуються.\nЯкщо все гаразд, завершуємо роботу «TVLINK» (Ctrl+C) та додаємо його в автостарт системи:\nwget https://raw.githubusercontent.com/AlexELEC/TVLINK-x86_64/master/tvlink.service -O /etc/systemd/system/tvlink.service systemctl enable tvlink systemctl start tvlink OpenWRT OpenWRT # Простий спосіб встановлення системи OpenWRT для архітектури х86-64 описано тут.\nРелізи для «OpenWRT x86-64» публікуються на цій сторінці.\nВерсія «OpenWRT» для якої скомпільована програма, вказана в описі релізу.\nОновимо репозиторії пакетів та встановимо залежності для модуля «Streamlink», який входить до складу «TVLINK». Послідовно дамо команди в терміналі:\nopkg update opkg install python3 python3-certifi python3-chardet python3-cryptodome python3-pip python3-requests python3-six tar wget python -m pip install --upgrade pip pip install pycountry isodate pysocks Завантажуємо та встановлюємо сам «TVLINK».\nwget https://github.com/AlexELEC/TVLINK-x86_64-OpenWRT/releases/download/4.1.4/TVLINK-4.1.4.tar.bz2 -O TVLINK-4.1.4.tar.bz2 mkdir -p /opt/tvlink tar -jxf TVLINK-4.1.4.tar.bz2 -C /opt/tvlink rm -f TVLINK-4.1.4.tar.bz2 Перевіряємо чи працює програма.\n/opt/tvlink/tvlink Якщо «TVLINK» запустився без помилок, закриваємо його (Ctrl+C). Завантажимо та додамо сервіс в автозавантаження.\ncd /etc/init.d wget https://raw.githubusercontent.com/AlexELEC/NanoPi-R1/ae/tvlink -O tvlink \u0026amp;\u0026amp; chmod +x tvlink service tvlink enable service tvlink start Оновлення програми # Як оновити програму читайте тут.\n"},{"id":5,"href":"/uk/docs/tvlink/docs/quick-start/","title":"Швидкий старт","section":"TVLINK","content":" Швидкий старт # Мається на увазі що всі налаштування встановлені за замовчуванням.\nПісля встановлення та запуску програми, введіть в вашому браузері адресу: «http://ip-address:2020». Де «ip-address», це адреса комп’ютера на якому встановлений «TVLINK».\nАктивуйте «Playlists sources» та натисніть кнопку «Add playlist».\nimg\nВ формі «Add new playlist» вкажіть назву плейлиста (Playlist name) та URL-адресу або шлях до файлу (Playlist path) цього плейлиста.\nназва плейлиста повинна бути латинськими літерами та без спеціальних символів шлях до файлу треба починати з «file://», наприклад: file:///Data/Media/playlist.m3u Після підтвердження «Save changes», активуйте перемикач «Add channels» цього джерела каналів і натисніть іконку «Update».\nimg\nВ результаті цих дій всі канали з вашого плейлиста будуть добавлені в «TVLINK», а саме на сторінку «Channels» (так званий «mapping» каналів). Цього вже буде достатньо щоб почати перегляд каналів.\nimg\nНа сторінці «About» ви можете завантажити плейлист (M3U Playlist) і відкрити його будь-якому IPTV-плеєрі, наприклад VLC.\n"},{"id":6,"href":"/uk/docs/tvlink/docs/srv-config/","title":"Налаштування сервера та потоків","section":"TVLINK","content":" Налаштування сервера. # Дана інформація стосується налаштувань на сторінці «Settings».\nimg\n«Server port» – задає порт на якому «TVLINK» приймає запити. Порт у потоків буде більший на одиницю: “Server port + 1”. «Playlist IP» – це адреса, яку «TVLINK» буде використовувати для плейлистів (коли «Auto playlist IP» вимкнено). Вибирається із списку. «Auto playlist IP» – якщо ввімкнуто, «TVLINK» буде використовувати ту IP-адресу в плейлисті, на яку робить запит клієнт. «Check internet IP» – IP-адреса за якою «TVLINK» перевіряє роботу інтернет. За замовчуванням використовуються адреса «8.8.8.8». Якщо вам потрібно змінити цю адресу перед запуском програми, створіть файл «check-internet.ip» в каталозі «tvlink» и впишіть туди потрібну адресу. «Check internet max time» – максимальний час, протягом якого «TVLINK» перевіряє роботу інтернет. Програма не запуститься поки у неї не буде доступу до інтернет. «Refresh sources at startup» – оновлювати джерела при старті програми. «Refresh sources at playlist» – оновлювати джерела при запиті плейлиста. «Create static playlist» – створює статичні файли плейлистів (основний і для профілів) в каталозі «tvlink/playlist» і видає його при запиті клієнтів. Це набагато пришвидшує роботу, коли ви маєте велику кількість каналів (100 і більше). Статичний плейлист створюється (оновлюється) кожного разу коли автоматично оновлюються джерела каналів, або ви натискаєте на «Update all sources» на сторінці «Sources». Для токенів (Authentication Token) статичні плейлисти не створюється. «Remove broken channels» – «TVLINK» автоматично буде видаляти усі канали, які виявилися непрацездатними. Будьте обережні з цією опцією, якщо зникне підключення до Інтернет, «TVLINK» почне видаляти кожен канал, який Ви будете вмикати. «Authentication webUI» – проста автентифікація (логін/пароль) для веб-інтерфейсу. Після активації ви відразу побачите вікно для введення даних. Вам потрібно ввести – “admin/admin”. Після цього ви можете вказати свої логін/пароль у полях «Login (webUI)» та «Password (webUI)» відповідно. Якщо в полі «Login (webUI)» ввести порожній рядок або менше трьох символів, логін буде скинутий на значення за замовчуванням (admin). Це стосується і поля «Password (webUI)»: порожній рядок або менше трьох символів скинуть пароль на “admin”. IP-адреси для списку «Playlist IP» беруться із системи. Якщо вам потрібно додати IP-адресу (або доменне ім’я) якої немає в системі (наприклад, якщо «TVLINK» працює за NAT), створіть файл «ip-address.ext» в каталозі «tvlink/data». Кожний рядок файлу повинен містити одну IP-адресу або доменне ім’я. Наприклад:\n100.100.100.100 200.200.200.200 my.own.server.com\nМаркер автентифікації для потоків та плейлистів. # img\nЗахист від несанкціонованого доступу до потоків та плейлистів.\n«Authentication Token» – вмикає підтримку маркерів автентифікації. «Main Token for playlist/streams» – будь-яка послідовність латинських літер та/або цифр, чутлива до регістру. Після будь-яких змін в налаштуваннях «Токенів» потрібно застосувати налаштування («Apply Settings» внизу сторінки) або перезавантажити програму.\nЯкщо у Вас ввімкнена опція «Create static playlist» то при будь-яких змінах в налаштуваннях «Токенів», не забувайте оновити статичні плейлисти (натисніть «Update all sources» на сторінці «Sources»).\nЯкщо опцію «Authentication Token» активовано, після застосування налаштувань , доступ до потоків та плейлистів здійснюється лише через токен. На сторінці «Settings» задається токен для основного плейлиста.\nimg\nІнші токени задаються в «Профілях користувачів».\nПеріодичне перезавантаження налаштувань. # img\nЦя функція перезавантажує налаштування «TVLINK» через вказані проміжки часу. Ця дія аналогічна «Apply Settings» внизу сторінки. Вона не перезавантажує саму програму, а тільки заново ініціює всі налаштування. Але, це сприяє очищенню оперативної пам’яті та закриттю всіх сокетів. Тому може бути корисна, коли сервер працює 24/7.\n«Reload by interval» – перезавантажувати модулі «TVLINK» через проміжок часу (у годиннику) вказаний у «Reload every hours». «Reload once a day» – перезавантажувати один раз на добу, у визначений параметром «Reload at o’clock» час. Час вказаний в цих опціях не точний. Наприклад, якщо вказано «Reload once a day» / «Reload at o’clock» – в 4 години, перезавантаження станеться між четвертою та п’ятою годинами.\n«Reload once a day» має вищий пріоритет. Якщо Ви увімкнете обидва параметри, перезавантаження модулів працюватиме один раз на добу.\nПерезавантаження відбуваються тільки якщо:\nкількість відкритих сокетів (з’єднань) перевищує 10 програма використовує більше ніж 60 Мб оперативної пам’яті для систем де RAM менше за 1.5 Гб та більше 120 Мб для систем де RAM перевищує 1.5 Гб. Щоб уникнути проблем із трансляцією потоків, функції спрацюють, якщо в цей момент «TVLINK» не веде мовлення (немає підключених клієнтів). Як тільки вимкнеться останній клієнт відбудеться перезавантаження модулів.\nЯкщо ввімкнена опція «Ignore connected clients on Reload», модулі «TVLINK» буде перезавантажено не зважаючи на те що є підключені кліенти.\n«Empty channel link» – дозволяє вписати своє посилання на потік, який буде відтворюватися якщо жодне з посилань на канал не працює.\nimg\n«Exclude these lines from channel names when mapping» – виключення слів з назв каналів. Ви можете виключити будь-які рядки з назви каналу для автоматичного зв’язування. Сама назва каналу при цьому залишається незмінною, проте «TVLINK» при автоматичному зв’язуванні відкидає вказану вами частину з назви. Розділювачем слів, які потрібно виключити з назви, є кома (без пробілів). Наприклад, при таких налаштуваннях\nвсі канали з такими іменами будуть вважатися одним і тим же каналом – «Discovery Science HD» .\n«Discovery Science HD» «Discovery Science HD orig» «Discovery Science HD PREMIUM+» Для інформації. Якщо в одному джерелі є канали, як показано вище, то найвищий пріоритет буде у потоку (посилання на потік) назва якого найдовша, тобто спочатку «Discovery Science HD PREMIUM+», потім «Discovery Science HD orig» і останній «Discovery Science HD».\n«M3U playlist settings» – дозволяє додати потрібні вам елементи після тегів «EXTM3U» та «EXTINF» в плейлист «TVLINK». Наприклад, це може бути інформація для періодичного оновлення списку каналів: «refresh=”3600″». Якщо ваш IPTV програвач підтримує це.\nНалаштування потоків. # img\n«Main User-Agent» – задає User-Agent за умовчанням. У деяких IPTV-провайдерів може стояти блокування по «user-agent». Вони віддають потік, тільки якщо запит іде від визначеної програми. Ви можете вказати «TVLINK», щоб він видавав себе за іншу програму.\nНаступні налаштування здебільшого відносяться до модуля «Streamlink» і відповідають за роботу з потоками.\n«Stream Ring buffer» – задає розмір буфера для потоків (в мегабайтах). Відповідає параметру «ringbuffer-size» в «Streamlink». «Chunk size» – задає розмір фрагмента під час читання потоку (в байтах). Чим більший розмір фрагмента, то менше навантаження на процесор. Чим менший розмір фрагмента, тим швидше відкривається потік. «Threads job timeout» – час (в секундах) через який буде припинено роботу ланцюжка по читанню/запису фрагментів потоку. Коли це спрацьовує «Streamlink» перестане транслювати потік, але може не закрити з’єднання. Тому рекомендується вибирати значення для цього параметра біле ніж максимальне значення в опціях «General HTTP timeout» та «HLS segment timeout», про які йдеться нижче. Частково відповідає параметру «stream-timeout» в «Streamlink». «General HTTP timeout Connect/Data» – загальний тайм-аут (в секундах) , який використовується для всіх HTTP-запитів, крім тих, які охоплюються іншими параметрами. Для розуміння: в HLS-потоках це буде таймаут для отримання списку сигментів. Окремо встановлюється час (таймаут) для підключення та час на отримання даних, відповідно. Відповідає параметру «http-timeout» в «Streamlink», окрім того, що дає змогу встановити різні значення для з’єднання та читання даних. «HLS segment timeout Connect/Data» – тайм-аут (в секундах) , який використовується для HLS-сегментів (а також DASH и тому подібне). Окремо встановлюється час (таймаут) для підключення та час на отримання даних, відповідно. Відповідає параметру «stream-segment-timeout» в «Streamlink», окрім того, що дає змогу встановити різні значення для з’єднання та читання даних. «HLS segment queue threshold» – Коефіцієнт множення цільової тривалості списку відтворення HLS, після якого потік буде зупинено достроково, якщо після оновлення списку відтворення у чергу не буде поставлено нових сегментів. Відповідає параметру «hls-segment-queue-threshold» в «Streamlink». «Stream retry count» – ця опція встановлює переметри «stream-segment-attempts» та «hls-playlist-reload-attempts» для «Streamlink». Тобто кількість спроб завантаження для сигментів та списку сигментів. «Segment threads» – кількість паралельних завантажень сегментів. Це розмір пулу потоків, який використовується для завантаження сегментів. Відповідає параметру «stream-segment-threads» в «Streamlink». «Segments Queue» – розмір черги сегментів. В «Streamlink» вона є сталою, 20 сегментів. Але це забагато для Live-потоків. Чим меньша чегра тим скоріш будуть закриватися потоки, а також буде меньше споживання оперативної пам’яті та кількості відкритих сокетів. Краще встановити «as threads», тобто відповідає кількості «Segment threads» але не меньше чим 6 сегментів. «HLS live edge» – задає скільки HLS-сегментів потрібно завантажити при старті потоку. Відповідає параметру «hls-live-edge» в «Streamlink». «HLS playlist reload time» – контролює час через який виконується запит для оновлення списку сегментів. Частково відповідає параметру «hls-playlist-reload-time» в «Streamlink». Параметр «segment» має таке ж значення як і в «Streamlink». Значення «duration» відповідає «default» в «Streamlink». Значення «average» це середній час двох сегментів. Значення «default» це або одне зі значень яким відповідають «duration» / «segment», або якщо їх не має встановлено час – 6 секунд. «HLS Stream Data» – якщо активовано, негайно передає дані з сегмента в вихідний буфер під час завантаження. Канали відкриваються швидко, без попередньої буферизації перед стартом. Якщо вимкнено, дані передаються тільки після завантаження першого сигмента. Відповідає параметру «hls-segment-stream-data» в «Streamlink». «HLS Live Restart» – якщо активно, перейти до початку прямої трансляції або якнайдалі назад. Відповідає параметру «hls-live-restart» в «Streamlink». «Debug Streams» – додає журнал роботи модуля «Streamlink» в журнал роботи «TVLINK». Файл журналу роботи знаходиться в каталозі «tvlink/log». «Sources Proxy» та «Streams Proxy» – дозволяють встановити проксі для джерел та потоків. Формат: «http://login:password@your.proxy:port». Значення «login/password» не обов’язкові. Підтримуються протоколи: http, https, socks5.\nДля більшості налаштувань на цій сторінці, щоб зміни набули чинності, потрібно перечитати конфігурацію «TVLINK». Для цього є опція «Apply Settings» внизу сторінки. Опції «Refresh sources at playlist» та «Remove broken channels» цього не потребують.\nimg\nТакі налаштування потоків як:\nThreads job timeout General HTTP timeout HLS segment timeout HLS segment queue threshold Stream retry count HLS live edge HLS Stream Data HLS Live Restart Ви можете встановити окремо для кожного джерела на сторінці «Sources» (іконка біля назви джерела). При цьому не потрібно тиснути на «Apply Settings», зміни набувають чинності одразу.\nЦі самі параметри не потребують перезавантаження і на сторінці «Settings».\nКнопка «Default» в формі «Streamer settings» повертає всі окремі налаштування потоків для джерела до основних налаштувань на сторінці «Settings».\nПоля:\nPlaylist URL – дає можливість змінити URL-адресу джерела User-Agent – дає можливість встановити опцію “User-Agent” для кожного джерела (потоків в цьому джерелі) окремо. Підміняє собою опцію «Main User-Agent» Зміни в налаштуваннях цих полів відбуваються одразу як поле втрачає фокус.\nОпис деяких, не дуже зрозумілих, параметрів «TVLINK». # Спочатку визначимо, чим відрізняються тайм-аути з’єднань і читання даних (Connect timeout та Read Data timeout).\n«Connect timeout» Коли клієнт (у цьому випадку TVLINK буде клієнтом по відношенню до серверу звідки він запитує потоки) ініціалізує з’єднання, він повинен отримати відповідь від сервера (спеціальний код відповіді). Не важливо, яка саме відповідь прийде від сервера. Це може бути відповідь 200 (підключення встановлено) або 302 (переадресація) або будь-яка інша, головне, щоб сервер відповів. Якщо в проміжок часу зазначеного в тайм-аут з’єднання (час очікування підключення) відповідь від сервера не надійшла, клієнт скидає з’єднання.\n«Read Data timeout» Коли клієнт отримує відповідь 200 (підключення встановлено) від сервера, він починає завантажувати (читати) дані, які віддає сервер. Якщо за проміжок часу вказаного в тайм-аут читання даних (час очікування читання даних) сервер не передає інформацію, клієнт скидає з’єднання.\nТепер визначимся з форматами потоків.\nНайбільше розповсюджені з них це: TS та HLS.\n«TS» це по суті теж саме, якби ви завантажували якийсь файл у браузері. Клієнт робить запит і, якщо отримує відповідь 200, просто послідовно отримує дані. Дані передаються в один потік і, якщо з трафіком виникають проблеми, це викликає проблеми і з відео. Тобто для IPTV через інтернет не краще рішення. Більше підходить для локальної мережі.\n«HLS» це той же самий «TS» (спрощено звичайно), але порізаний на куски (сегменти). За рахунок того, що ці сегменти, це вже записані файли (у відмінності від TS, які ідуть у реальному часі) та їх (цих файлів) кілька, клієнт має можливість одночасно завантажити кілька сегментів. Що в свою чергу допомагає боротися з проблемами трафіку, і відповідно більше підходить для IPTV через інтернет.\nТепер безпосередньо про параметри «TVLINK».\n«General HTTP timeout Connect/Data» Якщо у вас TS-потік, саме ці тайм-аути будуть працювати. «HLS segment» тайм-аути не будуть приймати участь для таких потоків.\nЯкщо у вас HLS-потік, «General HTTP» тайм-аути працюватимуть, коли ви отримуєте плейлисти зі списком сегментів або варіантів якості потоків (провайдер може надати кілька варіантів якості потоків для різних швидкостей з’єднання). Плейлистами ми називаємо текстові файли, які містять посилання на інші плейлисти (наприклад, якщо це список якості потоків) або посилання на відеосегменти.\n«HLS segment timeout Connect/Data» Ці таймаути працюють безпосередньо з сегментами (відеофайлами). Хоча в назві цього параметра стоїть «HLS», ​​ці таймаути працюють і з іншими форматами сегментованих потоків. Наприклад, «DASH».\nУ простому випадку (без списку якості потоків) для HLS-потоків це буде виглядати так:\nотримання списку сегментів – «General HTTP timeout» завантаження сегменту 1 – «HLS segment timeout» завантаження сегменту 2 – «HLS segment timeout» завантаження сегменту 3 – «HLS segment timeout» отримання нового списку сегментів – «General HTTP timeout» завантаження сегменту 4 – «HLS segment timeout» завантаження сегменту 5 – «HLS segment timeout» завантаження сегменту 6 – «HLS segment timeout» отримання нового списку сегментів – «General HTTP timeout» і так далі…\n«HLS segment queue threshold» Цей параметр (тайм-аут) теж відноситься до HLS-потоків. Список HLS-сегментів (плейлист) містить змінну, де вказана тривалість відео в сегменті. Ця змінна використовується «TVLINK» для того, щоб дізнатися через який час запросити новий файл сегментів. Сервер постійно оновлює цей список, як тільки закінчено запис нового сегмента.\n«HLS segment queue threshold» це число на яке буде помножено змінна тривалості сегмента. І якщо протягом часу (який ми отримали при множенні) на сервері не оновився список сегментів, клієнт розірве з’єднання.\nНаприклад, у списку зазначено, що тривалість сегмента 6 секунд. «HLS segment queue threshold» у нас дорівнює трьом. Через 18 секунд клієнт розірве з’єднання, якщо на сервері не з’явився новий сегмент.\n«Threads job timeout» Це тайм-аут внутрішнього циклу «Streamlink», який читає дані зі входу і записує у вихідний потік. Якщо протягом зазначеного часу через цикл не проходять дані, він припиняє роботу. Відповідно, будь-яке з’єднання закривається. Закривається, це в теорії. Але в силу того, що модулі «Streamlink» не ідеальні з’єднання можуть залишитися відкритими. Тому я рекомендую ставити тут значення більше, ніж таймаути в «General HTTP» та «HLS segment».\n«Stream retry count» Число повторних спроб з’єднання при спрацьовуванні «General HTTP» та «HLS segment» тайм-аутів.\nFFmpeg transcode stream. # Якщо у вашій системі встановлено «FFmpeg», ви маєте можливість увімкнути модуль «FFmpeg transcode stream».\nimg\nОпції – це параметри командного рядка FFmpeg. Призначення полів:\n«Before input» – для параметрів апаратного транскодінгу «Video encoder» – параметри відео енкодера «Audio encoder» – параметри аудіо енкодера Щоб було зрозуміло, як будуть вставлені ці параметри в командний рядок «FFmpeg», ось приклад (спрощена схема):\n/usr/bin/ffmpeg -err_detect ignore_err -stream_loop -1 [Before input] -i http://channel.stream -c:v [Video encoder] -c:a [Audio encoder] -ignore_unknown -map 0:v -map 0:a -f mpegts За замовчуванням «Video/Audio encoder» містить параметр “copy”. Тобто якщо ці рядки порожні, буде встановлено значення “copy” (пропускати потік без перекодування).\nПеред тим, як встановлювати значення, переконайтеся, що «FFmpeg» в системі підтримує ті чи інші параметри. Наприклад, дайте команду\nffmpeg -hide_banner -encoders щоб подивитися доступні аудіо/відео енкодери.\nЯкщо процесор у вашій системі (наприклад, Intel Pentium N5000) підтримує апаратне кодування потоків, можна зробити, наприклад, такі налаштування.\nBefore input: -hwaccel vaapi -hwaccel_output_format vaapi -hwaccel_device /dev/dri/renderD128 Video encoder: h264_vaapi -r 50 Audio encoder: aac -b:a 96k Після застосування налаштувань (Apply Settings) на сторінці «About» з’явиться посилання на «M3U FFmpeg Playlist» (формат: http://ip-address:port/ffmpeglist).\nУвімкнення «FFmpeg transcode stream» не впливає на основний модуль трансляції. Вони працюють паралельно. Ви можете одночасно підключити одних клієнтів до звичайного плейлиста (playlist), а інших до плейлиста «FFmpeg» (ffmpeglist).\nЗа посиланням «http://ip-address:port/ffmpeglist» ви завжди можете отримати плейлист, навіть якщо «FFmpeg transcode stream» вимкнено і в системі немає «FFmpeg». Тому будьте уважні.\nЯкщо увімкнути «Debug Streams» та запустити «TVLINK» з командного рядка, при зупинці потоку буде виведено інформацію «FFmpeg» (кодування, помилки тощо).\nОновлення EPG. # img\nЦі налаштування відповідають за періодичне оновлення «EPG».\n«Auto update EPG» – увімкнути/вимкнути періодичне оновлення EPG. «Update period EPG» – вибрати зі списку період оновлення в годинах, або один раз на добу (вночі).\n"},{"id":7,"href":"/uk/docs/tvlink/docs/source/","title":"Налаштування джерел каналів","section":"TVLINK","content":" Джерела плейлистів. # Активуйте перемикач «Playlists sources». Натисніть кнопку «Add playlist». У вікні «Add new playlist»:\nВведіть назву плейлиста. Вона має бути латинськими літерами, без спеціальних символів (пробілів, тире та інше) та не може починатися з цифри. Введіть url-адресу плейлиста. Якщо файл плейлиста збережений на локальному комп’ютері, формат адреси повинен бути таким: «file:///path_to/your_playlist_file» (наприклад, file:///Data/list/playlist.m3u). Натисніть кнопку «Save changes».\nimg\nДжерела доповнень. # Натисніть кнопку «Add addon». У вікні «Add new addon» натисніть у полі «Addon name». З’явиться перелік готових доповнень які вже присутні в репозиторії. Виберіть той що вам потрібен і натисніть «Save changes».\nimg\nВи можете створити власне доповнення. Як це зробити, читайте тут.\nДжерела Ministra/Stаlker Middleware. # Натисніть кнопку «Add portal». У вікні «Add new Portal (Stаlker Middleware)» введіть:\nНазву порталу (Portal name). Вона має бути латинськими літерами, без спеціальних символів (пробілів, тире та інше) та не може починатися з цифри. Url-адресу порталу (Portal url). MAC-адресу для доступу до порталу (User MAC). Не обов’язковий перемикач «Use HLS streams» дозволяє отримувати HLS-потоки, якщо Портал підтримує такий спосіб. На етапі створення краще не вмикати цей параметр, якщо ви не впевнені в підтримці порталом HLS-потоків.\nimg\nПісля того як ви натиснете кнопку «Save changes», в каталозі «tvlink/scrapers» буде створено файл з іменем вашого порталу. В цьому прикладі «tvlink/scrapers/Portal.py». Цей файл містить три змінні які ви можете редагувати (це не обов’язково):\nINCLUDE_GROUP – це список груп каналів які ви хочете отримувати. Всі інші групи будуть ігноруватися (не потраплять в список). Зауважте, що перевіряться точний збіг, враховуючи регістр символів.\nEXCLUDE_NAME – список в якому можно задати символи, які будуть виключені із назви каналу. Наприклад: якщо назва каналу «US Discovery HD», а ви хочете мати «Discovery HD», зробіть EXCLUDE_NAME = [‘US ‘]. Зауважте, в цьому прикладі є пропуск в кінці ‘US ‘.\nDEFAULT_LOGO – url-адреса іконки, яка буде застосована для каналів де іконка відсутня, або якщо ввімкнена опція «Disable load icons» в налаштуваннях джерела.\nПісля редагування цих змінних потрібно натиснути «Apply Settings» на сторінці «Settings» або перезавантажити програму.\nimg\nОпції «Portal url», «User MAC», «Use HLS streams», «Disable load icons» та «Repeat source streams» ви можете змінювати без перезавантаження налаштувань, але потрібно оновити джерело (іконка Update).\nimg\n«Disable load icons» – вимикає отримання іконок каналів з порталу. На деяких порталах прописані недійсні адреси іконок. Це призводить до затримки (залежить від вашого браузера) відображення списків каналів в веб-інтерфейсі програми.\n«Repeat source streams» – дозволяє встановити кількість повторів програвання потоку під час збоїв. Ця опція не має відношення до Streamlink-опції «Stream retry count». Значення “always” – повтори не обмежені, “0” – функція відключена (за замовчуванням), інші значення – кількість повторів. Детальніше тут.\nПозволяет установить количество повторов проигрывания потока при сбоях. Эта опция не имеет отношения к Streamlink-опции \u0026ldquo;Stream retry count\u0026rdquo;. Значение \u0026ldquo;always\u0026rdquo; - повторы не ограничены, \u0026ldquo;0\u0026rdquo; - функция отключена (по умолчанию), остальные значения - количество повторов. Лучше будет об\u0026rsquo;ъяснить на примере: если ваш канал имеет всего один поток и при условии, что этот поток хоть как-то работает - TVLINK бесконечно будет пытаться перезапустить этот поток. Функция \u0026ldquo;Repeat source streams\u0026rdquo; делает тоже самое для источника (потока этого источника) канала где больше чем один поток. Таким образом, переключение на следующий поток этого канала произойдет при условии: или поток совсем перестал работать или по выбраному вами количеству повторов. Если выбрано \u0026ldquo;always\u0026rdquo; - то только если поток перестал хоть что-то отдавать.\nДжерела AceStream. # Натисніть кнопку «Add Acestream». У вікні «Add new AceStream source» введіть:\nНазву джерела (Source name). Вона має бути латинськими літерами, без спеціальних символів (пробілів, тире та інше) та не може починатися з цифри.\nUrl-адресу сервера «AceStream» в форматі http://ip-address:port (наприклад: http://192.168.1.1:6878).\nНе обов’язковий перемикач «Use HLS streams» дозволяє отримувати HLS-потоки. Не рекомендуеться вмикати якщо серевер «AceStream» працює в вашій локальній мережі, це суттєво збільшить час перемикання каналів.\nПісля того як ви натиснете кнопку «Save changes», ви можете в налаштуваннях джерела вписати групу/групи каналів які ви хочете отримати в поле «Channel Categories (comma-delimited)». За замовчуванням це поле порожня і це означає, що будуть завантажені всі канали всіх груп (їх біля 3000). Назви офіційних груп ви знайдете тут. Користувачі які запускають трансляції можуть створювати свої назви груп обо зовсім ігнорувати створення групи. Тому, якщо вам потрібні всі канали які є в базі «AceStream» то залиште поле «Channel Categories (comma-delimited)» пустим.\nimg\nБаза каналів завантажуеться напряму з «AceStream Server-side Search API» і не залежить від інших ресурсів (наприклад таких як: pomoyka.i2p).\nТаблиця Джерела. # img\n«Name» – ім’я джерела, налаштування та видалення цього джерела. Коли джерело активне та оновлене, ім’я стає посиланням на редагування (співставлення) каналів для цього джерела. Іконка налаштувань відображається синім кольором, якщо джерело має налаштування потоків «за замовчуванням», і зелений колір, якщо користувач змінив параметри. «Catchup» – вибір архіву. Підтримуються типи: «Append», «Shift» та «Flussonic». «Enable» – вмикає або вимикає джерело. «Prio» – пріоритет джерела. Чим менше значення тим більший пріоритет. «Limit» – обмежує доступ клієнтів до джерела. Значення, це максимальна кількість клієнтів які можуть дивитись одночасно з цього джерела. «Add channels» – якщо цей перемикач увімкнений і ви оновите джерело, всі канали джерела будуть автоматично додано у список каналів «TVLINK» (channels mapping). Це працює тільки при ручному (примусовому) оновленні каналів, при автоматичному оновленні ця опція ігнорується. «New channels» – якщо цей перемикач увімкнений, при оновленні джерела, в список каналів «TVLINK» будуть добавлятися нові канали, якщо вони з’явились в цьому джерелі. «Update period» – час (в годинах) через який джерело буде автоматично оновлюватися. Нуль, означає що оновлення вимкнуте. «Update» – негайне оновлення джерела, а також час останнього оновлення. «Links» – кількість посилань на потоки (канали) які містить джерело.\nДодавання каналів в список. # Є два варіанти, як ви можете добавити (channels mapping) канали з джерела в список каналів «TVLINK»:\nУвімкнути перемикач «Add channels» та натиснути «Update». В цьому випадку всі канали джерела будуть автоматично додано у список каналів «TVLINK». Оновити джерело, натиснувши «Update». Після цього назва джерела стає посиланням на сторінку де ви можете добавляти канали в ручному режимі. img\nПеремикач «Map» додає канал до списку каналів «TVLINK». При додаванні каналів створюється група до якої належить канал і переноситься іконка.\nАвтоматичне об\u0026rsquo;єднання каналів. # «TVLINK» автоматично об’єднує канали з однаковими назвами. Тому кількість каналів джерела (Links) не завжди відповідає кількості каналів в списку «TVLINK». При об’єднанні, регістр символів та пробіли у назві каналу ігноруються. Наприклад, всі канали з такими іменами будуть вважатися одним і тим самим каналом:\nChannel 25 CHANNEL 25 ChaNNel25 Якщо в плейлисті або доповненні присутні групи каналів, вони також будуть експортовані. Якщо груп не має, усім каналам джерела буде присвоєно групу з назвою самого джерела.\nАрхіви каналів (Catchup). # Якщо ваш IPTV-провайдер надає таку функцію, виберіть один із типів архіву:\nAppend Flussonic Shift «none» – означає що функцію вимкнено. Який саме у вас тип архіву, ви можете дізнатися у свого IPTV-провайдера.\n«TVLINK» підтримує автоматичне перемикання архівних потоків під час збою, незалежно від типів архіву. Це означає, що при проблемі з архівним потоком з джерела де стоїть тип «Shift», станеться переключення на архівний потік з джерела з «Flussonic». Порядок перемикання залежить від пріоритету джерел. Тобто та ж функціональність, що й зі звичайними потоками.\nЯкщо ви використовуєте сторонній IPTV-плеєр (не PVR TVLINK Client), в його налаштуваннях треба встановити тип архіву «Shift». Тобто сам «TVLINK», в незалежності який тип архіву у джерела, буде видавати архіви в форматі «Shift».\nПріоритет джерела (Prio). # Якщо обидва джерела містять один і той же канал, то першим буде використаний потік із джерела з вищим пріоритетом (нижчою цифрою). Якщо цей потік не працює або припинив трансляцію в процесі роботи, «TVLINK» переключиться на наступне джерело з нижчим пріоритетом і так далі, по колу.\nОбмеження з’єднань з джерелом (Limit). # Якщо джерело має обмеження на кількість підключень до потоків, встановіть потрібне значення. Це потрібно, щоб ваш IPTV-провайдер не заблокував вам доступ. «TVLINK» буде автоматично перемикати на наступний потік якщо ліміт буде перевищено.\n«TVLINK» перемикає канали в асинхронному режимі. Це означає, що програма не чекає на закриття попереднього потоку перед тим як відкрити наступний. В іншому випадку, канали би перемикались дуже повільно. Ідентифікація клієнтів відбувається за їх IP-адресою. Ці два факти накладають деякі обмеження на роботу опції «Limit». А саме. Для клієнтів які мають одну і туж IP-адресу, «TVLINK» автоматично збільшує ліміт підключень. В журналі роботи програми ви будете бачити такий запис:\nIncrease MaxStream count [1+1 HD] from [MySouce]: set max stream [2] - limit [1] Це означає що для джерела «MySouce» встановлений ліміт на одне підключення. Але, так як при перемиканні каналу попередній потік ще не закрився, «TVLINK» автоматично збільшив ліміт (на одиницю). Якщо би цього не сталося, джерело «MySouce» не було би доступне у цей момент.\nТакож, якщо два клієнти мають однакову IP-адресу (на одній і тій же машині запущено два IPTV-програвача) та роблять запит до одного джерела, ліміт цього джерела теж буде збільшено на одиницю. Адже «TVLINK» не має можливості визначити, чи це запит на перемикання каналу одного і того самого клієнта, чи це запит від іншого клієнта. Так як IP-адреси у них однакові.\n«Update all sources» – натисніть якщо вам потрібно оновити всі джерела каналів разом (знаходиться внизу сторінки). Якщо в налаштуваннях сервера (Settings) ввімкнута опція «Create static playlist», також буде створено статичний плейлист.\n«Create static playlist» – якщо в налаштуваннях (сторінка Settings) у вас включена опція «Create static playlist», то внизу, на сторінці джерел (Sources), з’явиться посилання «Create static playlist». Це дозволяє оновити статичний плейлист, не оновлюючи всі джерела.\n"},{"id":8,"href":"/uk/docs/tvlink/docs/epg/","title":"Розклад передач (EPG)","section":"TVLINK","content":" Розклад передач (EPG). # Налаштування EPG потрібно проводити після того як ви добавили канали в «TVLINK» (channel mapping).\nВи можете використовувати джерела EPG які вже присутні в програмі (EPG Static sources), або створити свої (EPG Custom sources). Активуйте потрібний перемикач.\nimg\nЯкщо ви бажаєте створити своє джерело, натисніть кнопку «Add EPG» та заповніть форму «Add new EPG».\n«EPG name» – будь яка назва на ваш вибір, латинськими літерами та без спеціальних символів (тире, пробіл, тощо). «EPG url» – адреса XMLTV-файлу. Може бути заархівований (.tar.gz) або ні (.xmltv). Натисніть кнопку «Save changes», щоб зберегти налаштування.\nОпції. # «Name» – ім’я джерела та посилання (коли джерело активне та оновлене) на редагування (співставлення) каналів для цього джерела. «Enable» — увімкнення/вимкнення джерела. «Prio» – пріоритет. Якщо активно кілька джерел, «TVLINK» шукатиме відповідності канал-програма в порядку пріоритету джерел. Все що не знайшов у першому, шукатиме у другому і так далі. «File date» – якщо джерело XMLTV надає таку інформацію, тут буде вказана дата створення XMLTV-файлу джерела. Якщо така інформація не надається, тут буде вказана дата останнього завантаження файлу. «Update» – інформація про останнє зіставлення каналів та створення програми, а також кнопка «Оновити». Ця кнопка не створює програму, її дії обмежені завантаженням та автоматичним зіставленням назв каналів із програмою. Це потрібно, щоб ви могли вручну зіставити ті канали, які «TVLINK» не зміг зіставити автоматично. Або, змінити автоматичне зіставлення, якщо це потрібно. «Channels» – тут відображається загальна кількість назв каналів у джерелі. Просто інформація, тому що не завжди вказані в джерелі канали містять програму.\nКнопки. # «Create EPG» – створює програму. XMLTV-файл буде доступний за адресою: «http://ip-address:port/xmltv» «Clean manual EPG mapping» – очищає всі зіставлення, які ви зробили вручну. Після того, як Ви натиснули кнопку в колонці «Update» можна перейти за посиланням з колонки «Name» і зіставити канали які «TVLINK» не знайшов або змінити зіставлення тих каналів, що Вас не влаштовують.\nimg\n«Auto EPG mapping» – в цій колонці відображаються назви каналів з XMLTV-джерела які «TVLINK» зіставив автоматично. «Manual EPG mapping» – тут можна зіставити канали вручну.\nimg\nВідсортувавши таблицю по колонці «Auto EPG mapping», ми отримаємо вгорі списку всі канали які автоматично не були зіставленні (для зручності).\nТак як випадаючий список колонки «Manual EPG mapping» містить всі назви каналів з EPG-джерела, знайти потрібну досить важко. Щоб спростити завдання, потрібно ввести перші літери з назви каналу і список переміститься у потрібну позицію.\nПісля зроблених налаштувань потрібно повернутися на сторінку «Sources» і натиснути кнопку «Create EPG».\nВ джерелах «EPG Static sources» ви маєте можливість, при потребі, змінити URL-адресу. Для цього натисніть іконку «Edit» біля назви джерела.\nПеріодичність оновлення джерел EPG задається на сторінці «Settings» у підрозділі «EPG settings».\n"},{"id":9,"href":"/uk/docs/tvlink/docs/profiles/","title":"Профілі користувачів","section":"TVLINK","content":" Профілі користувачів. # Налаштування профілів потрібно проводити після того як ви добавили канали в «TVLINK» (channel mapping).\nПрофілі надають змогу мати різні набори каналів та груп для різних клієнтів. Канали та групи в профілях беруться із основного набору каналів на сторінці «Channels» (головний профіль), тому спочатку потрібно добавити в «Channels» всі канали які можуть вам знадобитися в профілях.\nТакож, при створенні профілю ви маєте можливість встановити IP-адресу для потоків та плейлистів цього профілю та маркер автентифікації (token), якщо це потрібно.\nНатисніть кнопку «Add user» в «User Profiles» та заповніть форму «Add user profile».\n«User» – ім’я клієнта. Латинськими літерами та без спеціальних символів (тире, пробіл, тощо). «Playlist IP» – адреса яка буде використовуватися для плейлистів та потоків цього профілю. «Token for playlist/streams» – токен який буде використовуватися для плейлистів та потоків цього профілю якщо активовано опцію «Authentication Token». Якщо залишити рядок пустим, токен буде створено автоматично. «Comment» – будь який коментар. Окрім рядка «User», всі інші заповнювати не обов’язково.\nimg\nПісля підтвердження (Save changes), ім’я профілю (User) стає посиланням. Перехід за цим посиланням відкриває налаштування груп і каналів профілю.\nimg\nВи можете вимикати (вмикати) групи або канали які не повинні бути у цьому профі.\nІконка «Налаштування» біля імені профілю, дозволяє змінити всі опції (Playlist IP, Token, Comment).\nПісля будь-яких змін в налаштуваннях «Токенів» потрібно застосувати налаштування («Apply Settings» внизу сторінки) або перезавантажити програму.\nЯкщо у Вас ввімкнена опція «Create static playlist» то при будь-яких змінах в налаштуваннях «Токенів» або «Playlist IP», не забувайте оновити статичні плейлисти (натисніть «Update all sources» на сторінці «Sources»).\nІконка «Видалення» – видаляє профіль.\nВ колонці «Playlist URL» відображаються посилання на плейлист профілю в форматі:\nhttp://\u0026lt;ip-address\u0026gt;:\u0026lt;port\u0026gt;/\u0026lt;token\u0026gt;/playlist/\u0026lt;user\u0026gt; token – якщо активовано «Authentication Token» user – ім’я профілю Для «PVR TVLINK Client» ім’я профілю та токен достатньо вказати в налаштуваннях.\n"},{"id":10,"href":"/uk/docs/tvlink/docs/channels/","title":"Канали","section":"TVLINK","content":" Дана інформація стосується налаштувань на сторінці «Channels».\nСписки каналів всіх сторінках інтерфейсу відображаються порціями по 200 каналів на сторінку (знизу є кнопки для перегортання сторінок). При видаленні або зв’язуванні каналів самі сторінки не оновлюються, лише видаляються елементи. Це зроблено для прискорення роботи, щоб не чекати при кожній дії, поки оновиться сторінка. Але це вносить певну плутанину. Наприклад, у вас список складається з 300 каналів: 200 каналів на одній сторінці та інші на другій. Якщо Ви видалите 10 каналів з першої сторінки, то при переході на другу Ви побачите вже не 100 каналів, а 90. При оновленні сторінки прочитався список заново і на першій сторінці так само 200 каналів, а на другій все інше. Просто пам’ятайте про це під час редагування.\nЛоготипи каналів. # Щоб встановити або змінити логотип каналу натисніть іконку в стовпчику «Logo». В формі яка з’явиться ви можете вказати url-адресу потрібного зображення і натиснути «Save changes». Бажано, щоб зображення було в «png» форматі, але допускаються і інші (jpg, gif, bmp).\nimg\nЯкщо ви скопіювали власні логотипи каналів у папку «tvlink/logos», то натиснувши кнопку «Local logos» Ви можете зіставити логотип каналу.\nНайвищий пріоритет мають іконки, які розташовані в каталогу «tvlink/logos» та мають формат «ID-каналу.png» (наприклад: 7B7ADBFF.png). «ID-каналу» ви можете бачити у стовпчику «ID». Якщо такої іконки немає, «TVLINK» бере іконку, яку Ви зазначили вище.\nЯкщо канал не має іконки, вона буде автоматично додана, коли ви робите примусове оновлення будь-якого джерела з увімкненою опцією «Add channels». За умови, що імена каналів збігаються, і у джерела є іконка цього каналу.\nУтиліта «picons». # Дозволяє завантажувати іконки каналів з сайту «epg.one» та автоматично конвертує імена логотипів у формат зрозумілий для «TVLINK» (наприклад: 7B7ADBFF.png).\nУтиліта консольна, запускається в терміналі. Розміщена в каталозі “tvlink”, треба вказати повний шлях. Наприклад:\n/storage/.config/tvlink/picons Довідка по аргументам:\n/patch_to/tvlink/picons -h Запуск «picons» без аргументів завантажує та конвертує “transparent” іконки.\nТе саме, завантажити і конвертувати іконки, можна зробити і в веб-інтерфейсі «TVLINK», на сторінці «Sources».\nimg\nВиберіть потрібні опції і натисніть «Create picons».\nНомери каналів. # В стовпчику «Num» ви можете вказати номери каналів. Можна вказати номер лише одному каналу або не вказувати зовсім, у плейлисті каналам все одно будуть присвоєні номери (в алфавітному порядку назв каналів). Якщо вказано номер хоч одного каналу, відлік почнеться з нього. Якщо не вказати номер жодному каналу, відлік почнеться з одиниці.\nНазви каналів. # В стовпчику «Name» ви можете редагувати назви каналів. Зміни набирають чинності, як тільки рядок з назвою каналу втрачає фокус.\nГрупи каналів. # В стовпчику «Group» ви можете змінювати групу якій належить канал. Групи вибираються зі списку.\nЯкщо потрібно змінити групу для декількох каналів разом:\nПоставите відмітки в полях «Clean» напроти каналів групу яких ви хочете змінити. Змініть групу на одному з відмічених каналів. Таким чином, ви зміните групу для всіх обраних каналів.\nimg\nНатискання на саму назву «Clean» знімає відмітки зі всіх обраних каналів. Це на той випадок, якщо ви помилились з вибором.\nПараметри каналів. # Іконки в стовпчику «Control» (зліва на право):\n«Info» – інформація та управління потоками каналу «Join» – об’єднання каналів та їх потоків «Break» – роз’єднування каналів «Delete» – видалення каналів\nInfo.\nЯкщо вам треба вимкнути або ввімкнути якісь потоки каналу, переведіть перемикач «Enable» у потрібне положення.\nimg\nВ цій таблиці потоки (посилання) розташовані в порядку їх пріоритету. Тобто, в тій послідовності в якій «TVLINK» буде їх перемикати якщо станеться збій попереднього потоку.\nJoin.\n«TVLINK» автоматично об’єднує канали з однаковими іменами. Регістр символів та пробіли у назві каналу ігноруються. Також ви можете об’єднувати канали самостійно. Для цього потрібно вибрати канали (в стовпчику «Clean») які ви би хотіли додати і натиснути «Join» каналу з яким ви хочете їх об’єднати.\nimg\nBreak.\nЦя процедура протилежна попередній.\nDelete.\nВидаляє канал із списку каналів «Channels». При цьому канал стає знову доступним в своєму джерелі.\nID каналів. # img\nВ цьому стовпчику відображаються унікальний ідентифікатор каналу і містить пряме посилання на цей канал. Це посилання можна вставити в плеєр (наприклад VLC) щоб відтворити канал або просто записати потік в браузері. Щоб потім програвати записаний канал в плеєрі, додайте файлу розширення «.ts».\nІконка «Play» біля «ID» каналу, відкриває простий веб-програвач. Це для зручності, коли вам потрібно протестувати канал. Веб-програвач не підтримує перемикання потоків, а також може не відтворювати деякі канали.\n«Delete channels» внизу сторінки, видаляє всі канали із списку каналів «Channels».\n"},{"id":11,"href":"/uk/docs/tvlink/docs/gpoups/","title":"Групи каналів","section":"TVLINK","content":" Групи каналів # Дана інформація стосується налаштувань на сторінці «Groups».\nГрупи. # img\nКнопки.\n«Create new group» – дозволяє створити нову групу. Нова група стає доступною на сторінці «Channels». «Clean all groups» – видаляє всі групи без винятку.\nТаблиця.\n«Title» – ім’я групи. Якщо змінити назву групи, зміниться назва групи всіх каналів які належать до цієї групи (мається на увазі, на сторінці «Channels»). Якщо іншій групі дати таку саму назву, ці дві групи об’єднаються в одну. «Enabled» – якщо вимкнути, всі канали цієї групи будуть видалені на сторінці «Channels» та при оновлені (чи додаванні нових) джерел, канали які належать до цієї групи не будуть додаватися в список каналів «TVLINK». Якщо ввімкнути (після вимкнення) та оновити джерело/джерела, канали цієї групи повернуться в «Channels». «Control» – синя іконка дозволяє задати «Псевдоніми» для групи. Червона, видаляє групу. Псевдоніми груп задаються через кому. Регістр символів у псевдонімах не має значення. Можна написати: “Films”, “FILMS” або “FiLmS”. Якщо для групи вказано псевдонім, то при зіставленні каналів (channels mapping) група джерела буде замінена оригінальною у списку каналів «Channels».\nimg\nПеревіряється не повний збіг із шаблоном (псевдонімом), а входження слова в шаблон. Наприклад, якщо для групи “Films” задати псевдонім – “Films and series”. До групи “Films” потраплять такі групи (без урахування регістру): “Films and series”, “Series” та звісно “Films”.\nВидалити групу ви можете тільки в тому випадку, якщо цій групі не належить ні один канал на сторінці «Channels». Інакше, «TVLINK» не дозволить вам це зробити. Ви можете, наприклад, спочатку вимкнути групу, а вже потім видалити, якщо в групі є канали.\nСортування груп. # «Sort groups» внизу сторінки відкриє ці налаштування.\nimg\nПорядок сортування задається числом. Чим менше число, тим вище група у списку. На сторінці сортування відображаються всі активні (не вимкнені) групи до яких доданий хоча б один канал, незалежно чи є цей канал на сторінці «Channels» в даний момент. Нумерація каналів (якщо вона є) має пріоритет над сортуванням груп. Щоб подивитися як виглядатиме список каналів та груп після їх сортування/нумерації, відсортуйте канали по «Group» на сторінці «Channels». Саме такий порядок каналів буде у плейлисті. Саме сортування (за номерами, іменами, групами) на сторінці «Channels» не впливає на плейлист, воно тільки для зручності редагування каналів.\n"},{"id":12,"href":"/uk/docs/tvlink/docs/status/","title":"Статус роботи та оновлення програми","section":"TVLINK","content":" Статус роботи та оновлення програми # Дана інформація стосується налаштувань на сторінках «Status» та «About».\nСтатус роботи програми. # img\nТаблиця в верхній частині сторінки «Status» відображає інформацію про використання програмою ресурсів системи. Інформація оновлюється кожні 10 секунд.\n«TVLINK start time» – дата та час коли була запущена (ініціалізовані налаштування) програма. «TVLINK uses memory» – кількість оперативної пам’яті яку займає програма в мегабайтах. «TVLINK open sockets» – кількість відкритих на даний момент сокетів. «Used system memory» – процент оперативної пам’яті який використовує система. Мається на увазі вся система і її процеси, а не тільки «TVLINK». Якщо в даний час відбувається трансляція потоків (до серверу під’єднані клієнти), відображаються таблиця «Active streams».\nimg\nЦе інформація:\n«Client» – IP адреса та порт клієнта. «Channel» – канал який транслюється клієнту. «Source» – джерело з якого транслюється потік. «Start Time» – час коли була запущена трансляція. «URL» – адреса з якої «TVLINK» бере потік. Червона іконка в стовпчику «Client» дозволяє перемкнути трансляцію на наступний потік для клієнта.\nЗа посиланням «View program Logs» (внизу сторінки) відкривається сторінка з журналом роботи програми. Оновлення інформації на цій сторінці також відбувається кожні 10 секунд.\nimg\nОновлення програми. # На сторінці «About» відображаються версія програми, а також посилання для завантаження плейлиста та EPG.\nimg\nЯкщо доступна нова версія програми, з’являться інформація про це та іконка «Update». Натисніть цю іконку і почекайте поки програма не оновиться.\nimg\nПри оновлені всі налаштування зберігаються. На всяк випадок, ви можете зберегти ваші налаштування скопіював каталог «tvlink/data» та при необхідності відновити його.\n"},{"id":13,"href":"/uk/docs/tvlink/docs/pvr-tvlink-client/","title":"PVR TVLINK Client","section":"TVLINK","content":" PVR TVLINK клієнт для Kodi # Як клієнт до «TVLINK» найкраще всього підходить «PVR TVLINK Client» для «Kodi». Тільки з цім клієнтом ви отримаєте всі можливості сервера «TVLINK». Такі, як наприклад, перемикання потоків (під час збоїв трансляції) одного і того самого каналу з різними форматами аудіо/відео не помітно для користувача. Клієнт підтримує “Timeshift” (пауза/перемотка), IPTV-архіви та EPG.\nimg\nКод клієнта базується на «PVR IPTV Simple» але зроблений так щоб відповідати всім вимогам «TVLINK». Наприклад, клієнт ніколи не розірве з’єднання з сервером «TVLINK» за власним бажанням. Це станеться тільки коли користувач перемикне канал або зупинить трансляцію каналу.\nДля «PVR TVLINK Client» потрібна модифікована версія «Kodi», він не буде працювати з оригінальним «Kodi».\nНалаштування. # img\nВкладка «General».\n«TVLINK IP-address» – ip-адреса сервера «TVLINK». «TVLINK port» – порт сервера «TVLINK». «TVLINK profile» – профіль користувача на сервері «TVLINK». Якщо не вказано використовується основний профіль (main). «Auth. Token» – токен авторизації, якщо потрібен. «FFmpeg playlist» – ввімкніть, якщо ви хочете отримувати трансляції які будуть оброблятися ffmpeg-модулем «TVLINK».\nВкладка «Streams».\nimg\n«TVLINK connection timeout» – тайм-аут з’єднання клієнта з сервером «TVLINK» для отримання списку каналів. Ця опція не впливає на трансляції. «Buffering streams» – якщо активовано, клієнт буде додатково буферизувати потоки (засобами Kodi). «FFmpegDirect for Timeshift» – вмикає функцію Timeshift через доповнення «Inputstream FFmpeg Direct». «FFmpegDirect for Catchup» – вмикає функцію Catchup через доповнення «Inputstream FFmpeg Direct».\nДві останні опції (FFmpegDirect for…*) будуть працювати тільки якщо ви встановите доповнення «Inputstream FFmpeg Direct». В іншому випадку кліент їх буде ігнорувати.\n«Timeshift» працює тільки коли ввімкненна опція «FFmpegDirect for Timeshift». Для роботи IPTV-архівів (Catchup) – «FFmpegDirect for Catchup» не обовязкова.\nЯ би не радив використовувати ці функції. Доповнення «Inputstream FFmpeg Direct» не корректно (на данний час) працює на деяких архітектурах, наприклад Intel. По друге, якщо ви включите «FFmpegDirect for Timeshift» – у вас перестане працювати автоматична зміна потоків в каналі. Доповнення «Inputstream FFmpeg Direct», через яке будуть проходити потоки, не вміє автоматично змінювати параметри потоку.\nВсі інші налаштування такі самі як і в «PVR IPTV Simple» клієнта.\nimg\n"},{"id":14,"href":"/uk/docs/tvlink/docs/tvlink-simple-conrol/","title":"TVLINK Simple Control","section":"TVLINK","content":" Доповнення «TVLINK Simple Control» для Kodi. # img\nДає змогу контролювати потоки каналу (вмикати/вимикати) та показує (виділяє жовтим кольором) посилання на потік який транслюється в цей момент.\nimg\nТакож дає можливість:\nпослідовно перемикати потоки каналу оновлювати джерела каналів «TVLINK» показувати інформацію по підключеним до «TVLINK» клієнтам показувати інформацію по використанню оперативної пам’яті та сокетам\nНалаштування. # img\n«IP-address TVLINK» – ip-адреса сервера «TVLINK» «Port TVLINK» – порт сервера «TVLINK»\nЯкщо сервер «TVLINK» і «TVLINK Simple Control» знаходиться на одній машині, і адреса сервера «TVLINK» в «PVR TVLINK Client» встановлена як «127.0.0.1», ви можете залишити налаштування за замовчуванням. Якщо не вказано «IP-address TVLINK», «TVLINK Simple Control» використовує адресу «127.0.0.1».\nВ модифікованих (ae-fork) ELEC-системах доповнення викликається довгим утриманням (longpress) кнопки «і» (info) клавіатури. Для пульта ДУ в цих системах зроблені такі налаштування файлу «keyboard.xml» в Kodi.\n\u0026lt;FullscreenLiveTV\u0026gt; \u0026lt;keyboard\u0026gt; … \u0026lt;i mod=\u0026quot;longpress\u0026quot;\u0026gt;RunAddon(script.tvlink.conrol)\u0026lt;/i\u0026gt; \u0026lt;/keyboard\u0026gt; \u0026lt;/FullscreenLiveTV\u0026gt; "},{"id":15,"href":"/uk/docs/tvlink/docs/addons-api/","title":"TVLINK addons API","section":"TVLINK","content":" Общие сведения. # Репозиторий с готовыми плагинами (которые можно использовать как примеры) находится здесь.\nДля создания своего или установки готового аддона активируйте \u0026ldquo;Addon sources\u0026rdquo; и нажмите кнопку \u0026ldquo;Add Addon\u0026rdquo; (на странице \u0026ldquo;Sources\u0026rdquo;).\nВам будет предложено ввести имя (латинские буквы без пробелов и спец. символов) нового аддона.\nЕсли аддон с таким именем есть в репозитории (имя файла без расширения \u0026ldquo;.py\u0026rdquo;) он будет автоматически установлен и активирован.\nЕсли такого аддона нет в репозитории, для него будет создана обертка.\nВ каталоге \u0026ldquo;/путь_к_tvlink/scrapers\u0026rdquo; появиться пустой файл нового аддона. В нашем примере это - \u0026ldquo;tvlink/scrapers/Test.py\u0026rdquo;. После того как Вы напишите код плагина (в файле Test.py), его можно активировать и использовать.\nAddons API.\nВ плагине обязательно должен быть подключен модуль \u0026ldquo;utils\u0026rdquo; (из TVLINK) который предоставляет нужные функции Цитировать (выделенное)\n-- coding: utf-8 -- # import os, sys\nroot_dir = os.path.dirname(sys.argv[0]) sys.path.append(root_dir)\nimport utils\nи должен быть определен класс \u0026ldquo;Scraper\u0026rdquo; с такими обязательными функциями (выделены жирным)\nЦитировать (выделенное) class Scraper: def init(self): # опционально, init можно не использовать self.source = \u0026lsquo;Test\u0026rsquo; self.link = \u0026rsquo;ext:{0}:\u0026rsquo;.format(self.source) self.headers = {\u0026lsquo;User-Agent\u0026rsquo;: \u0026lsquo;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0\u0026rsquo;}\ndef getHeaders(self): return self.headers def Channels(self): LL = [] # LL = ( (0-chID, 1-chTitle, 2-chGroup, 3-chUrl, 4-chLogo), ...) ... utils.ch_inputs_DB(self.source, LL) def getLink(self, lnk): ... return lnk Итак, в классе \u0026ldquo;Scraper\u0026rdquo; должны обязательно присутствовать функции: Channels(), getHeaders() и getLink(). Все остальное на Ваше усмотрение, Вы можете определить дополнительно любые классы, функции, переменные как в области видимости Scraper так и глобально.\nПройдемся по функциям в порядке их использования.\nChannels() - будет вызвана TVLINK когда нужно составить \u0026ldquo;карту каналов\u0026rdquo;, например, когда вы нажимаете кнопку \u0026ldquo;Update\u0026rdquo; источника (плагина).\nОсновное действие для TVLINK происходит в строке: Код utils.ch_inputs_DB(self.source, LL) Функция utils.ch_inputs_DB() (также обязательна) - принимает два аргумента:\n1) имя источника (должно совпадать с именем файла-аддона), self.source - в примере 2) список кортежей в котором перечислены параметры канала, LL - в примере Кортеж должен быть сформирован в таком формате и порядке:\nКод LL = ( (0-chID, 1-chTitle, 2-chGroup, 3-chUrl, 4-chLogo), ) chID - идентификатор канала chTitle - имя канала chGroup - группа канала chUrl - url канала chLogo - url иконки канала\nИз обязательного здесь: chID, chTitle и chUrl. По сути, Вам из сайта (для которого Вы пишите плагин) нужно взять как минимум два значения - chTitle и chUrl. Для получения chID нужно использовать функцию utils.title_to_crc32(chTitle) которая вернет идентификатор канала на основе аргумента chTitle. Все остальные переменные могут содержать пустую строку.\nВ общем случае, функция Channels() используется для получения и парсинга страницы сайта, чтобы заполнить кортеж переменными (0-chID, 1-chTitle, 2-chGroup, 3-chUrl, 4-chLogo) и передать его функции utils.ch_inputs_DB(). Нет ни каких ограничений на то, каким именно способом Вы получите эти значения, но \u0026ldquo;идентификатор канала\u0026rdquo; Вы должны получить именно через функцию - utils.title_to_crc32(chTitle).\nВторой важный момент. chUrl (url канала) - должен быть сформирован в следующем формате:\nКод ext:имя_аддона:http://ссылка_на_канал.html Например, если аддон называется \u0026ldquo;Telehub\u0026rdquo; а ссылка на нужный канал - \u0026ldquo; http://telehub.org/amedia-hit.html\", то chUrl у нас будет выглядеть так:\nКод ext:Telehub:http://telehub.org/amedia-hit.html Когда TVLINK включает канал по этой ссылке, он понимает (по префиксу \u0026ldquo;ext:Telehub\u0026rdquo;), что он должен вызвать функцию getLink() из аддона \u0026ldquo;Telehub\u0026rdquo; и передать ей в качестве аргумента ссылку - \u0026ldquo; http://telehub.org/amedia-hit.html\". Таким образом мы плавно подходим к функции getLink()\u0026hellip;\ngetLink() - будет вызвана когда Вы включаете канал из Вашего аддона и должна вернуть реальный адрес потока.\nЕсли Вы пишите аддон для сайта где опубликованы статические ссылки на потоки, вид этой функции будет такой (что получил - то и отдал):\nКод def getLink(self, lnk): return lnk На практике такое встречается крайне редко. Обычно ссылки на поток формируются на сайте динамически при открытии страницы канала, причем каждый раз новые. В этой функции Вы должны найти такую ссылку и вернуть ее TVLINK чтобы он смог ее \u0026ldquo;проиграть\u0026rdquo;. Опять же, способы этого добиться - ограничены только Вашей фантазией, главное верните ссылку на поток.\nМодуль \u0026ldquo;utils\u0026rdquo; из TVLINK предоставляет несколько вспомогательных функций которые Вы можете использовать в своем плагине и в частности в функциях Channels() и getLink() чтобы ускорить написание кода.\nutils.getURL(url, headers=None, referer=None) - возвращает страницу (сайта) по указанному адресу (url).\nТолько url-аргумент является обязательным. Если указан только url-аргумент, в запрос будет добавлен заголовок {\u0026lsquo;User-Agent\u0026rsquo;: \u0026lsquo;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0\u0026rsquo;}. Если в дополнение к User-Agent (по умолчанию) Вам нужно передать заголовок Referer сделайте так (referer=\u0026lsquo;строка\u0026rsquo;):\nКод html = utils.getURL(\u0026lsquo; http://telehub.org/amedia-hit.html', referer=\u0026lsquo; http://telehub.org\u0026rsquo;) Если этих заголовков не достаточно или User-Agent по умолчанию не подходит - задайте аргумент \u0026ldquo;headers\u0026rdquo; (словарь) где опишите все что нужно, например:\nКод headers = {\u0026lsquo;User-Agent\u0026rsquo;: \u0026lsquo;SmartSDK/1.5.63-rt-25\u0026rsquo;, \u0026lsquo;Accept\u0026rsquo;: \u0026rsquo;text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8\u0026rsquo;, \u0026lsquo;Accept-Language\u0026rsquo;: \u0026lsquo;ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\u0026rsquo;, \u0026lsquo;Referer\u0026rsquo;: \u0026lsquo; http://site.org\u0026rsquo;}\nhtml = utils.getURL(\u0026lsquo; http://site.org/amedia-hit.html', headers=headers)\nutils.mfind(html, start_string, end_string) - ищет в строке (html) начальную (start_string) и конечную (end_string) строки и возвращает найденное между ними. Например как здесь.\ngetHeaders() - последняя обязательная функция класса \u0026ldquo;Scraper\u0026rdquo;. Вызывается когда TVLINK открывает поток и должна вернуть заголовки (словарь) которые требуются для запроса потока.\nТо есть, мы маскируемся под браузер когда открываем поток:\nКод def getHeaders(self): headers = {\u0026lsquo;User-Agent\u0026rsquo;: \u0026lsquo;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0\u0026rsquo;, \u0026lsquo;Accept\u0026rsquo;: \u0026rsquo;text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8\u0026rsquo;, \u0026lsquo;Accept-Language\u0026rsquo;: \u0026lsquo;ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3\u0026rsquo;, \u0026lsquo;Referer\u0026rsquo;: \u0026lsquo; http://site.org\u0026rsquo;} return headers\nДля парсинга страниц сайта удобно использовать модуль \u0026ldquo;BeautifulSoup\u0026rdquo;. Если Вы хотите использовать этот модуль в своем плагине - его нужно подключить. Делается это так:\nЦитировать (выделенное)\n-- coding: utf-8 -- # import os, sys\nroot_dir = os.path.dirname(sys.argv[0]) libs_dir = os.path.join(root_dir, \u0026rsquo;libs\u0026rsquo;) ssv_file = os.path.join(libs_dir, \u0026lsquo;soupsieve.whl\u0026rsquo;) bs4_file = os.path.join(libs_dir, \u0026lsquo;beautifulsoup.whl\u0026rsquo;)\nsys.path.append(root_dir) sys.path.append(libs_dir) sys.path.insert(0, ssv_file) sys.path.insert(0, bs4_file)\nimport utils from bs4 import BeautifulSoup\n"}]